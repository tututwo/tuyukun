import{S as Vt,i as Zt,s as ut,k as te,q as Gt,C as Lr,l as re,m as ie,h as T,r as Yt,D as zr,n as $e,E as Q,F as be,G as Ir,H as Mr,I as Or,a as qe,c as Xe,b as Y,d as Se,f as Br,g as ke,J as Wr,y as Dr,z as Ur,A as Fr,K as qr,L as Xr,M as Hr,N as Vr,O as Zr,P as Gr,B as Yr,v as Kr}from"../chunks/index.743a3fa8.js";import{p as Jr}from"../chunks/stores.0cb66c83.js";import"../chunks/functions.6a1aed10.js";const Qr=({url:e})=>({currentRoute:e.pathname}),rs=Object.freeze(Object.defineProperty({__proto__:null,load:Qr},Symbol.toStringTag,{value:"Module"}));const ei=[":",";",",","(",")","[","]","{","}","π","±","+","-","*","/","%",'"',"'","`","@","="],v={escape:e=>e=="\\",space:e=>/[\r\n\t\s]/.test(e),digit:e=>/^[0-9]$/.test(e),sign:e=>/^[+-]$/.test(e),dot:e=>e==".",quote:e=>/^["'`]$/.test(e),symbol:e=>ei.includes(e),hexNum:e=>/^[0-9a-f]$/i.test(e),hex:(e,t,r)=>e=="0"&&v.letter(t,"x")&&v.hexNum(r),expWithSign:(e,t,r)=>v.letter(e,"e")&&v.sign(t)&&v.digit(r),exp:(e,t)=>v.letter(e,"e")&&v.digit(t),dots:(e,t)=>v.dot(e)&&v.dot(t),letter:(e,t)=>String(e).toLowerCase()==String(t).toLowerCase(),comment:(e,t)=>e=="/"&&t=="*",inlineComment:(e,t)=>e=="/"&&t==="/",selfClosedTag:(e,t)=>e=="/"&&t==">",closedTag:(e,t)=>e=="<"&&t=="/"};class B{constructor({type:t,value:r,pos:i,status:n}){this.type=t,this.value=r,this.pos=i,n&&(this.status=n)}isSymbol(...t){let r=this.type=="Symbol";return t.length?t.some(i=>i===this.value):r}isSpace(){return this.type=="Space"}isNumber(){return this.type=="Number"}isWord(){return this.type=="Word"}}function R(e){let t=-1,r=e.length,i=-1,n=0;return{curr(s=0){return e[t+s]},next(s=1){let a=e[t+=s];return a===`
`?(n++,i=0):i+=s,a},end(){return t>=r},get(){return{prev:e[t-1],curr:e[t+0],next:e[t+1],next2:e[t+2],next3:e[t+3],pos:[i,n]}}}}function ti(e){for(;e.next();){let{curr:t,prev:r}=e.get();if(v.comment(t,r))break}}function ri(e){for(;e.next()&&e.curr()!==`
`;);}function mt(e){return[":",";",",","{","}","(",")","[","]"].includes(e)}function pt(e){let t="";for(;!e.end();){let{curr:r,next:i}=e.get();t+=r;let n=v.symbol(i)||v.space(i)||v.digit(i);if(t.length&&n&&!v.closedTag(r,i))break;e.next()}return t.trim()}function ii(e){let t="";for(;!e.end();){let{curr:r,next:i}=e.get();if(t+=r,!v.space(i))break;e.next()}return t}function dt(e){let t="",r=!1;for(;!e.end();){let{curr:i,next:n,next2:s,next3:a}=e.get();if(t+=i,r&&v.dot(n)||(v.dot(i)&&(r=!0),v.dots(n,s)))break;if(v.expWithSign(n,s,a))t+=e.next()+e.next();else if(v.exp(n,s))t+=e.next();else if(!v.digit(n)&&!v.dot(n))break;e.next()}return t}function ni(e){let t="0x";for(e.next(2);!e.end();){let{curr:r,next:i}=e.get();if(t+=r,!v.hexNum(i))break;e.next()}return t}function ce(e){return e[e.length-1]}function M(e,t={}){let r=R(String(e).trim()),i=[],n=[];for(;r.next();){let{prev:a,curr:l,next:u,next2:o,pos:c}=r.get();if(v.comment(l,u))ti(r);else if(t.ignoreInlineComment&&v.inlineComment(l,u))ri(r);else if(v.hex(l,u,o)){let f=ni(r);i.push(new B({type:"Number",value:f,pos:c}))}else if(v.digit(l)||v.digit(u)&&v.dot(l)&&!v.dots(a,l)){let f=dt(r);i.push(new B({type:"Number",value:f,pos:c}))}else if(v.symbol(l)&&!v.selfClosedTag(l,u)){let f=ce(i),m=v.digit(u)||v.dot(u)&&v.digit(o);if(l==="-"&&m&&(!f||!f.isNumber())){let p=dt(r);i.push(new B({type:"Number",value:p,pos:c}));continue}let h={type:"Symbol",value:l,pos:c};if(n.length&&v.escape(f.value)){i.pop();let p=pt(r);p.length&&i.push(new B({type:"Word",value:p,pos:c}))}else v.quote(l)&&(ce(n)==l?(n.pop(),h.status="close"):(n.push(l),h.status="open")),i.push(new B(h))}else if(v.space(l)){let f=ii(r),m=ce(i),{next:h}=r.get();if(!n.length&&m){let p=m.value,d=mt(p)&&p!==")",g=mt(h)&&h!=="(";if(d||g)continue;f=t.preserveLineBreak?l:" "}i.length&&h&&h.trim()&&i.push(new B({type:"Space",value:f,pos:c}))}else{let f=pt(r);f.length&&i.push(new B({type:"Word",value:f,pos:c}))}}let s=ce(i);return s&&s.isSpace()&&(i.length=i.length-1),i}function si(e){let t=R(M(e));return Kt(t)}function Kt(e){let t=[];for(;e.next();){let{curr:r,next:i}=e.get();if(r.value==="var"){if(i&&i.isSymbol("(")){e.next();let n=li(e);ai(n.name)&&t.push(n)}}else if(t.length&&!r.isSymbol(","))break}return t}function li(e){let t={},r=[];for(;e.next();){let{curr:i,next:n}=e.get();if(i.isSymbol(")",";")&&!t.name){t.name=gt(r);break}else i.isSymbol(",")?(t.name===void 0&&(t.name=gt(r),r=[]),t.name&&(t.fallback=Kt(e))):r.push(i)}return t}function gt(e){return e.map(t=>t.value).join("")}function ai(e){return!(e===void 0||e.length<=2||e.substr(2).startsWith("-")||!e.startsWith("--"))}function C(e,t,r){return e=Number(e)||0,Math.max(t,Math.min(r,e))}function ui(e,t){return e?typeof t=="function"?t():t:""}function oi(e,t,r){let i=0,n=e,s=u=>u>0&&u<1?.1:1,a=arguments.length;a==1&&([e,t]=[s(e),e]),a<3&&(r=s(e));let l=[];for(;(r>=0&&e<=t||r<0&&e>t)&&(l.push(e),e+=r,!(i++>=65535)););return l.length||l.push(n),l}function Jt(e,t){for(let[r,i]of Object.entries(t))e[r]=e[i];return e}function _t(e){return/^[a-zA-Z]$/.test(e)}function x(e){return e==null}function Le(e){return x(e)||Number.isNaN(e)}function F(e){return x(e)||e===""}function He(e){let t=r=>(...i)=>e(r,...i);return t.lazy=!0,t}function ci(e,t){let[r,i=1]=String(e).split(/[x-]/);r=C(Math.ceil(r)||1,1,65536),i=C(Math.ceil(i)||1,1,65536);let n=r*i,s=[],a=1;if(/x/.test(e))for(let l=1;l<=i;++l)for(let u=1;u<=r;++u)s.push(t(a++,u,l,n,r,i));else if(/-/.test(e))if(n=Math.abs(r-i)+1,r<=i)for(let l=r;l<=i;++l)s.push(t(l,l,1,n,n,1));else for(let l=r;l>=i;--l)s.push(t(l,l,1,n,n,1));else for(let l=1;l<=r;++l)s.push(t(l,l,1,r,r,1));return s}function ee(e,t,r){return"c-"+e+"-"+t+"-"+r}function E(e){let t=e;for(;t&&!x(t.value);)t=t.value;return x(t)?"":t}function fi(e){return(x(e)?Date.now():String(e).replace(/\/.png$/g,""))+".png"}function Qt(e,t,r=0){let i=new Image;i.crossOrigin="anonymous",i.src=e,i.onload=function(){setTimeout(t,r)}}function Ve(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Ze(e){let t=document.createElement("textarea");return t.innerHTML=e,t.value}function hi(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Ge(e,t=0){let r=3735928559^t,i=1103547991^t;for(let n=0,s;n<e.length;n++)s=e.charCodeAt(n),r=Math.imul(r^s,2654435761),i=Math.imul(i^s,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&i)+(r>>>0)}function mi(e){let t=r=>x(r)?"":r;return(r,...i)=>{let n=pi(r).reduce((s,a,l)=>s+a+t(i[l]),"");return e(n)}}function er(){let e=0;return(t="")=>`${t}-${++e}`}function z(e,t,r){return t+e*(r-t)}function K(e=""){return e+Math.random().toString(32).substr(2)}function pi(e){return x(e)?[]:Array.isArray(e)?e:[e]}function A(e,t={symbol:",",noSpace:!1}){let r=[],i=[],n=[],s=[];if(F(e))return r;let a=R(M(e));function l(u){let o=t.symbol||",";return t.noSpace?u.isSymbol(o):u.isSymbol(o)||u.isSpace()}for(;a.next();){let{prev:u,curr:o,next:c}=a.get();o.isSymbol("(")&&n.push(o.value),o.isSymbol(")")&&n.pop(),o.status==="open"&&s.push(o.value),o.status==="close"&&s.pop();let f=!n.length&&!s.length;if(f){let m=t.noSpace&&o.isSpace()&&l(c),h=t.noSpace&&o.isSpace()&&l(u);if(m||h)continue}f&&l(o)?(r.push(yt(i)),i=[]):i.push(o)}return i.length&&r.push(yt(i)),r}function yt(e){return e.map(t=>t.value).join("")}function di(e,t){let r=[],i,n=[],s=[];for(;e.next();){let{curr:a,next:l}=e.get();a.isSymbol("(")&&!n.length?s.push(a):a.isSymbol(")")&&!n.length&&s.pop();let u=!n.length&&!s.length&&(!l||a.isSymbol(";")||l.isSymbol("}"));if(a.isSymbol("'",'"')&&(a.status==="open"?n.push(a):n.pop(),l&&l.isSymbol("}")&&!n.length&&(u=!0)),!s.length&&!n.length&&a.isSymbol("{")){let o=tr(r);if(!o.length)continue;let c=o.pop(),f=Ye(...o,c);for(i=je(ot(e,Te(c,{type:"block",inline:!0,name:c,value:[]})),f);c=o.pop();)i=je(Te(c,{type:"block",name:c,value:[i]}),f);break}if(r.push(a),u)break}return r.length&&!i?t.value=ne(r):i&&(t.value=i),t.origin&&(t.origin.value=t.value),t}function ot(e,t){let r=[],i=[],n=t&&t.type||"",s=[];for(;e.next();){let{prev:a,curr:l,next:u}=e.get();l.isSymbol("(")&&s.push(l.value),l.isSymbol(")")&&s.pop();let o=!u||l.isSymbol("}");if(ze(n)&&o){!u&&r.length&&!l.isSymbol("}")&&typeof r[r.length-1].value=="string"&&(r[r.length-1].value+=";"+l.value),t.value=r;break}else if(l.isSymbol("{")){let c=tr(i);if(!c.length)continue;Ye(t.name)&&(c=[ne(i)]);let f=c.pop(),m=Ye(...c,t.name,f),h=je(ot(e,Te(f,{type:"block",name:f,value:[]})),m);for(;f=c.pop();)h=je(Te(f,{type:"block",name:f,value:[h]}),m);r.push(h),i=[]}else if(l.isSymbol(":")&&!s.length&&!gi(a,u)&&i.length){let c=_i(i,d=>d.isSymbol(",")),f={type:"statement",name:"unkown",value:""};c.length>1&&(f.origin={name:c});let m=di(e,f),h=A(m.value),p=c.length>1&&h.length===c.length;c.forEach((d,g)=>{let y=Object.assign({},m,{name:d});/^\-\-/.test(d)&&(y.variable=!0),p&&(y.value=h[g]),r.push(y)}),ze(n)&&(t.value=r),i=[]}else l.isSymbol(";")?r.length&&i.length&&(r[r.length-1].value+=";"+ne(i),i=[]):i.push(l)}return r.length&&ze(n)&&(t.value=r),n?t:r}function gi(e,t){const r=["xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"];let i=e&&e.value,n=t&&t.value;return r.includes(i+":"+n)}function ne(e){return e.filter((t,r)=>!(t.isSymbol(";","}")&&r===e.length-1)).map(t=>t.value).join("")}function je(e,t){let r=e.name||"",[i,...n]=r.split(/#/),s=n[n.length-1];return i&&s&&!t&&(e.name=i,e.value.push({type:"statement",name:"id",value:s})),e}function _i(e,t){let r=[],i=[];return e.forEach(n=>{t(n)?(r.push(ne(i)),i=[]):i.push(n)}),i.length&&r.push(ne(i)),r}function tr(e){let t=[],r=R(e),i;for(;r.next();){let{prev:n,curr:s,next:a}=r.get(),l=n&&a&&s.value==="x"&&n.isNumber()&&a.isNumber();s.isWord()&&!i&&!l?t.push(s.value.trim()):t[t.length-1]=(t[t.length-1]+s.value).trim(),s.isSymbol()?i=!0:s.isSpace()||(i=!1)}return t}function Te(e,t){let r=Object.assign({},t);if(/\*\s*[0-9]/.test(e)){let[i,n]=e.split("*");n&&(r.times=n.trim(),r.pureName=i.trim())}return r}function Ye(...e){return e.some(t=>t==="style")}function ze(e){return e==="block"}function yi(e){let t,r=[];for(let i of e.value)i.name==="svg"&&(t=i),i.variable&&r.push(i);return t?(t.value.push(...r),t):e}function Ke(e,t){let r=R(M(e)),i=ot(r,t||{type:"block",name:"svg",value:[]});return yi(i)}function Je(e,t){let r="";if(e.type==="block"){let i=Array.isArray(e.value)&&e.value[0]&&e.value[0].inline;if(e.times?r+="@M"+e.times+"("+e.pureName+"{":r+=e.name+(i?" ":"{"),Array.isArray(e.value)&&e.value.length){let n="";for(let s of e.value)r+=Je(s,n),s.origin&&(n=s.origin.name.join(","))}e.times?r+="})":i||(r+="}")}else if(e.type==="statement"){let i=e.origin&&t===e.origin.name.join(","),n=e.origin?e.origin.name.join(","):e.name,s=e.origin?e.origin.value:e.value;i||(r+=s&&s.type?n+":"+Je(s):n+":"+s+";")}return r}function vi(e){return Je(e).trim()}function fe(e){return x(e)?[]:Array.isArray(e)?e:[e]}function he(e,t=`
`){return(e||[]).join(t)}function b(e,t=1){return x(e)?"":e[e.length-t]}function vt(e){return e[0]}function bi(e){return JSON.parse(JSON.stringify(e))}function xi(e){return[].concat(e,e)}function rr(e,t){return Array.prototype.flatMap?e.flatMap(t):e.reduce((r,i)=>r.concat(t(i)),[])}function wi(e){return e.filter(t=>!x(t)&&String(t).trim().length)}const N={func(e=""){return{type:"func",name:e,arguments:[]}},argument(){return{type:"argument",value:[]}},text(e=""){return{type:"text",value:e}},pseudo(e=""){return{type:"pseudo",selector:e,styles:[]}},cond(e=""){return{type:"cond",name:e,styles:[],arguments:[]}},rule(e=""){return{type:"rule",property:e,value:[]}},keyframes(e=""){return{type:"keyframes",name:e,steps:[]}},step(e=""){return{type:"step",name:e,styles:[]}}},S={white_space(e){return/[\s\n\t]/.test(e)},line_break(e){return/\n/.test(e)},number(e){return!isNaN(e)},pair(e){return['"',"(",")","'"].includes(e)},pair_of(e,t){return{'"':'"',"'":"'","(":")"}[e]==t}},Ee={π:Math.PI,"∏":Math.PI};function bt(e){return["@canvas","@shaders","@doodle"].includes(e)}function ir(e=""){let t=0,r=1,i=1;return{curr(n=0){return e[t+n]},end(){return e.length<=t},info(){return{index:t,col:r,line:i}},index(n){return n===void 0?t:t=n},range(n,s){return e.substring(n,s)},next(){let n=e[t++];return n==`
`?(i++,r=0):r++,n}}}function $i(e,{col:t,line:r}){console.warn(`(at line ${r}, column ${t}) ${e}`)}function Si(e){return e.trim().length?S.number(+e)?+e:e.trim():e}function ct(e){return function(t,r){let i=t.index(),n="";for(;!t.end();){let s=t.next();if(e(s))break;n+=s}return r&&t.index(i),n}}function nr(e,t){return ct(i=>/[^\w@]/.test(i))(e,t)}function ki(e){return ct(t=>/[\s\{]/.test(t))(e)}function sr(e,t){return ct(i=>S.line_break(i)||i=="{")(e,t)}function ji(e,t){let r,i=N.step();for(;!e.end()&&(r=e.curr())!="}";){if(S.white_space(r)){e.next();continue}else if(!i.name.length)i.name=ur(e);else if(i.styles.push(Ce(e,t)),e.curr()=="}")break;e.next()}return i}function Ti(e,t){const r=[];let i;for(;!e.end()&&(i=e.curr())!="}";){if(S.white_space(i)){e.next();continue}else r.push(ji(e,t));e.next()}return r}function Ei(e,t){let r=N.keyframes(),i;for(;!e.end()&&(i=e.curr())!="}";){if(r.name.length){if(i=="{"||e.curr(-1)=="{"){e.next(),r.steps=Ti(e,t);break}}else{if(nr(e),r.name=ki(e),!r.name.length){$i("missing keyframes name",e.info());break}continue}e.next()}return r}function Re(e,t={}){for(e.next();!e.end();){let r=e.curr();if(t.inline){if(r==`
`)break}else if((r=e.curr())=="*"&&e.curr(1)=="/")break;e.next()}t.inline||(e.next(),e.next())}function Ai(e){for(e.next();!e.end()&&e.curr()!=">";)e.next()}function Ni(e){let t="",r;for(;!e.end()&&(r=e.curr())!=":";)S.white_space(r)||(t+=r),e.next();return t}function Qe(e,t,r){let i=[],n=[],s=[],a="",l,u="";for(;!e.end();){l=e.curr();let o=e.index();if(/[\('"`]/.test(l)&&e.curr(-1)!=="\\")s.length?(l!=="("&&b(s)==="("&&s.pop(),l!="("&&l===b(s)?s.pop():s.push(l)):s.push(l),a+=l;else if(l=="@"&&!r)n.length||(a=a.trimLeft()),a.length&&(n.push(N.text(a)),a=""),n.push(lr(e));else if(r&&/[)]/.test(l)||!r&&/[,)]/.test(l))if(s.length)l==")"&&b(s)==="("&&s.pop(),a+=l;else{if(a.length&&(n.length?/\S/.test(a)&&n.push(N.text(a)):n.push(N.text(Si(a))),a.startsWith("±")&&!r)){let c=a.substr(1),f=bi(n);b(f).value="-"+c,i.push(Ie(f)),b(n).value=c}if(i.push(Ie(n)),[n,a]=[[],""],l==")")break}else Ee[l]&&!/[0-9]/.test(e.curr(-1))&&(l=Ee[l]),a+=l;if(t&&(e.curr(1)==")"||!/[0-9a-zA-Z_\-.]/.test(e.curr()))&&!s.length){n.length&&i.push(Ie(n));break}else u+=e.range(o,e.index()+1),e.next()}return[Pi(i),u]}function Pi(e){let t=b(e[0]);return t&&t.type==="text"&&!String(t.value).trim().length&&(e[0]=e[0].slice(0,-1)),e}function Ie(e){let t=e.map(n=>{if(n.type=="text"&&typeof n.value=="string"){let s=String(n.value);s.includes("`")&&(n.value=s=s.replace(/`/g,'"')),n.value=s}return n}),r=vt(t)||{},i=b(t)||{};if(r.type=="text"&&i.type=="text"){let n=vt(r.value),s=b(i.value);typeof r.value=="string"&&typeof i.value=="string"&&S.pair_of(n,s)&&(r.value=r.value.slice(1),i.value=i.value.slice(0,i.value.length-1),t.cluster=!0)}return t}function Ri(e){let t="",r="";if(/\D$/.test(e)&&!/\d+[x-]\d+/.test(e)||Math[e.substr(1)])return{fname:e,extra:r};for(let i=e.length-1;i>=0;i--){let n=e[i],s=e[i-1],a=e[i+1];if(/[\d.]/.test(n)||(n=="x"||n=="-")&&/\d/.test(s)&&/\d/.test(a))r=n+r;else{t=e.substring(0,i+1);break}}return{fname:t,extra:r}}function Ci(e){let t=JSON.stringify(e);return t.includes("pureName")&&t.includes("times")}function lr(e){let t=N.func(),r="@",i,n=!1;for(e.next();!e.end();){i=e.curr();let l=i=="."&&e.curr(1)=="@",u=e.curr(1);if(i=="("||l){n=!0,e.next();let[o,c]=Qe(e,l,bt(r));if(r==="@svg"&&/\d\s*{/.test(c)){let f=Ke(c);if(Ci(f)){let m=vi(f);m+=")",o=Qe(ir(m),l,bt(r))[0]}}t.arguments=o;break}else if(!n&&u!=="("&&!/[0-9a-zA-Z_\-.]/.test(u)){r+=i;break}else r+=i;e.next()}let{fname:s,extra:a}=Ri(r);return t.name=s,a.length&&t.arguments.unshift([{type:"text",value:a}]),t.position=e.info().index,t}function ar(e){let t=N.text(),r=0,i=!0,n;const s=[],a=[];for(s[r]=[];!e.end();){if(n=e.curr(),i&&S.white_space(n)){e.next();continue}else i=!1;if(n==`
`&&!S.white_space(e.curr(-1)))t.value+=" ";else if(n==","&&!a.length)t.value.length&&(s[r].push(t),t=N.text()),s[++r]=[],i=!0;else if(/[;}<]/.test(n)){t.value.length&&(s[r].push(t),t=N.text());break}else n=="@"?(t.value.length&&(s[r].push(t),t=N.text()),s[r].push(lr(e))):(!S.white_space(n)||!S.white_space(e.curr(-1)))&&(n=="("&&a.push(n),n==")"&&a.pop(),Ee[n]&&!/[0-9]/.test(e.curr(-1))&&(n=Ee[n]),t.value+=n);e.next()}return t.value.length&&s[r].push(t),s}function ur(e){let t="",r;for(;!e.end()&&(r=e.curr())!="{";)S.white_space(r)||(t+=r),e.next();return t}function Li(e){let t={name:"",arguments:[]},r;for(;!e.end();){if((r=e.curr())=="(")e.next(),t.arguments=Qe(e)[0];else{if(/[){]/.test(r))break;S.white_space(r)||(t.name+=r)}e.next()}return t}function or(e,t){let r=N.pseudo(),i;for(;!e.end();){if(i=e.curr(),i=="/"&&e.curr(1)=="*")Re(e);else{if(i=="}")break;if(S.white_space(i)){e.next();continue}else if(!r.selector)r.selector=ur(e);else{let n=Ce(e,t);if(n.property=="@use"?r.styles=r.styles.concat(n.value):r.styles.push(n),e.curr()=="}")break}}e.next()}return r}function Ce(e,t){let r=N.rule(),i,n=e.index();for(;!e.end();){if(i=e.curr(),i=="/"&&e.curr(1)=="*")Re(e);else{if(i==";")break;if(r.property.length){r.value=ar(e);break}else if(r.property=Ni(e),r.property=="@use"){r.value=zi(e,t);break}}e.next()}let s=e.index();return r.raw=()=>e.range(n,s).trim(),r}function cr(e,t){let r=N.cond(),i;for(;!e.end();){if(i=e.curr(),i=="/"&&e.curr(1)=="*")Re(e);else{if(i=="}")break;if(!r.name.length)Object.assign(r,Li(e));else if(i==":"){let n=or(e);n.selector&&r.styles.push(n)}else if(i=="@"&&!sr(e,!0).includes(":"))r.styles.push(cr(e));else if(!S.white_space(i)){let n=Ce(e,t);if(n.property&&r.styles.push(n),e.curr()=="}")break}}e.next()}return r}function xt(e,t){let r="";return e&&e.get_variable&&(r=e.get_variable(t)),r}function fr(e,t){e.forEach&&e.forEach(r=>{if(r.type=="text"&&r.value){let i=si(r.value);r.value=i.reduce((n,s)=>{let a="",l="",u;a=xt(t,s.name),!a&&s.fallback&&s.fallback.every(o=>{if(l=xt(t,o.name),l)return a=l,!1});try{u=J(a,t)}catch{}return u&&n.push.apply(n,u),n},[])}r.type=="func"&&r.arguments&&r.arguments.forEach(i=>{fr(i,t)})})}function zi(e,t){return e.next(),(ar(e)||[]).reduce((i,n)=>{fr(n,t);let[s]=n;return s.value&&s.value.length&&i.push(...s.value),i},[])}function J(e,t){const r=ir(e),i=[];for(;!r.end();){let n=r.curr();if(S.white_space(n)){r.next();continue}else if(n=="/"&&r.curr(1)=="*")Re(r);else if(n==":"){let s=or(r,t);s.selector&&i.push(s)}else if(n=="@"&&nr(r,!0)==="@keyframes"){let s=Ei(r,t);i.push(s)}else if(n=="@"&&!sr(r,!0).includes(":")){let s=cr(r,t);s.name.length&&i.push(s)}else if(n=="<")Ai(r);else if(!S.white_space(n)){let s=Ce(r,t);s.property&&i.push(s)}r.next()}return i}function et(e,t=64){const[r,i,n]=[1,t,t*t];let[s,a,l]=(e+"").replace(/\s+/g,"").replace(/[,，xX]+/g,"x").split("x").map(f=>parseInt(f));const u=s==1||a==1?n:i,o=s==1&&a==1?n:r,c={x:C(s||r,1,u),y:C(a||s||r,1,u),z:C(l||r,1,o)};return Object.assign({},c,{count:c.x*c.y*c.z,ratio:c.x/c.y})}function Ii(e){let r=R(hr(M(e,{preserveLineBreak:!0,ignoreInlineComment:!0}))),i=[],n=[],s,a,l={textures:[]};for(;r.next();){let{curr:u,next:o}=r.get();if(u.isSymbol("{")){if(i.length)n.push(u);else{let c=Me(n);Mi(c)?(s=c,n=[]):n.push(u)}i.push("{")}else if(u.isSymbol("}"))if(i.pop(),!i.length&&s){let c=Me(n);s&&c.length&&(s.startsWith("texture")?l.textures.push({name:s,value:c}):l[s]=c,n=[]),s=null}else n.push(u);else!F(a)&&a!=u.pos[1]&&(n.push(wt()),a=null),u.isWord()&&u.value.startsWith("#")&&(n.push(wt()),a=o.pos[1]),n.push(u)}return F(l.fragment)&&(l.fragment=Me(n),l.textures=l.textures||[]),l}function Mi(e){return/^texture\w*$|^(fragment|vertex)$/.test(e)}function wt(){return new B({type:"LineBreak",value:`
`})}function hr(e){let t=e[0],r=e[e.length-1];for(;t&&t.isSymbol("(")&&r&&r.isSymbol(")");)e=e.slice(1,e.length-1),t=e[0],r=e[e.length-1];return e}function Me(e){return hr(e).map(t=>t.value).join("")}const Oi="http://www.w3.org/2000/svg",Bi="http://www.w3.org/1999/xlink";function $t(e,t){return`url("data:image/svg+xml;utf8,${encodeURIComponent(e)+(t?`#${t}`:"")}")`}function St(e){const t=`xmlns="${Oi}"`,r=`xmlns:xlink="${Bi}"`;return e.includes("<svg")||(e=`<svg ${t} ${r}>${e}</svg>`),e.includes("xmlns")||(e=e.replace(/<svg([\s>])/,`<svg ${t} ${r}$1`)),e}const Wi="http://www.w3.org/2000/svg",Di="http://www.w3.org/1999/xlink",Ui=er();class me{constructor(t,r=""){if(!t)throw new Error("Tag name is required");this.name=t,this.body=[],this.attrs={},this.isTextNode()&&(this.body=r)}isTextNode(){return this.name==="text-node"}find(t){let r=t.attrs.id,i=t.name;if(Array.isArray(this.body)&&r!==void 0)return this.body.find(n=>n.attrs.id===r&&n.name===i)}append(t){this.isTextNode()||this.body.push(t)}merge(t){for(let[r,i]of Object.entries(t.attrs))this.attrs[r]=i;Array.isArray(t.body)&&this.body.push(...t.body)}attr(t,r){if(!this.isTextNode())return r===void 0?this.attrs[t]:this.attrs[t]=r}toString(){if(this.isTextNode())return kt(this.body);let t=[""],r=[];for(let[i,n]of Object.entries(this.attrs))n=kt(n),t.push(`${i}="${n}"`);for(let i of this.body)r.push(i.toString());return`<${this.name}${t.join(" ")}>${r.join("")}</${this.name}>`}}function mr(e,t){return`${e}:${t};`}function pr(e){const t=e.value.map(r=>r.type==="block"?pr(r):mr(r.name,r.value)).join("");return`${e.name}{${t}}`}function kt(e){e=String(e);let t=e.startsWith('"')&&e.endsWith('"'),r=e.startsWith("'")&&e.endsWith("'");return t||r?e.substring(1,e.length-1):e}function tt(e,t,r,i){let n;if(t||(t=new me("root")),e.type==="block")if(e.name==="style"){if(Array.isArray(e.value)){let s=new me("style"),a=[];for(let l of e.value)l.type==="block"&&a.push(pr(l));s.append(a.join("")),t.append(s)}}else{let s=new me(e.name);i||(i=s,i.attr("xmlns",Wi));for(let l of e.value){let u=tt(l,s,e,i);u&&(n=u)}if(e.inline){let l=e.value.find(u=>u.type==="statement"&&u.name==="id");l?n=l.value:(n=Ui(e.name),s.attr("id",n))}let a=i.find(s);a?a.merge(s):t.append(s)}if(e.type==="statement")if(e.name==="content"){let s=new me("text-node",e.value);t.append(s)}else if(e.name.startsWith("style ")){let s=(e.name.split("style ")[1]||"").trim();if(s.length){let a=t.attr("style")||"";t.attr("style",a+mr(s,e.value))}}else{let s=e.value;if(s&&s.type==="block"){let a=tt(e.value,i,e,i);s=`url(#${a})`,(e.name==="xlink:href"||e.name==="href")&&(s=`#${a}`)}t.attr(e.name,s),e.name.includes("xlink:")&&i.attr("xmlns:xlink",Di)}return r?n:i.toString()}function jt(e){return tt(e)}function dr(e){let t=R(M(e)),r={},i=!1;for(;t.next();){let{prev:n,curr:s,next:a}=t.get(),l=i&&(s.isWord()||s.isSymbol())&&n&&n.isNumber()&&!a;if(s.isNumber())r.value=Number(s.value),i=!0;else if(l)r.unit=s.value;else break}return r}function Tt(e){return(...t)=>{let r=[],i=[];for(let a of t){let{unit:l,value:u}=dr(a);l!==void 0&&r.push(l),u!==void 0&&i.push(u)}let n=e(...i),s=r.find(a=>a!==void 0);return s===void 0?n:Array.isArray(n)?n.map(a=>a+s):n+s}}function rt(e){return(...t)=>{let r=t.map(n=>String(n).charCodeAt(0)),i=e(...r);return Array.isArray(i)?i.map(n=>String.fromCharCode(n)):String.fromCharCode(i)}}const Fi={π:Math.PI,gcd:(e,t)=>{for(;t;)[e,t]=[t,e%t];return e}},it={"^":7,"*":6,"/":6,"÷":6,"%":6,"&":5,"|":5,"+":4,"-":4,"<":3,"<<":3,">":3,">>":3,"=":3,"==":3,"≤":3,"<=":3,"≥":3,">=":3,"≠":3,"!=":3,"∧":2,"&&":2,"∨":2,"||":2,"(":1,")":1};function Ae(e,t,r=[]){let i=[];for(;e.length;){let{name:n,value:s,type:a}=e.shift();if(a==="variable"){let l=t[s];Le(l)&&(l=Math[s]),Le(l)&&(l=Et(s,t)),Le(l)&&/^\-\D/.test(s)&&(l=Et("-1"+s.substr(1),t)),l===void 0&&(l=0),typeof l!="number"&&(r.push(l),Hi(r)?(l=0,r=[]):l=Ae(se(l),t,r)),i.push(l)}else if(a==="function"){let l=!1;/^\-/.test(n)&&(l=!0,n=n.substr(1));let u=s.map(f=>Ae(f,t)),o=n.split("."),c;for(;c=o.pop();){if(!c)continue;let f=t[c]||Math[c];u=typeof f=="function"?Array.isArray(u)?f(...u):f(u):0}l&&(u=-1*u),i.push(u)}else if(/\d+/.test(s))i.push(s);else{let l=i.pop(),u=i.pop();i.push(Xi(s,Number(u),Number(l)))}}return Number(i[0])||0}function qi(e){let t=String(e),r=[],i="";for(let n=0;n<t.length;++n){let s=t[n];if(it[s]){let a=b(r);if(s=="="&&a&&/^[!<>=]$/.test(a.value))a.value+=s;else if(/^[|&<>]$/.test(s)&&a&&a.value==s)a.value+=s;else if(s=="-"&&t[n-1]=="e")i+=s;else if(!r.length&&!i.length&&/[+-]/.test(s))i+=s;else{let{type:l,value:u}=a||{};l=="operator"&&!i.length&&/[^()]/.test(s)&&/[^()]/.test(u)?i+=s:(i.length&&(r.push({type:"number",value:i}),i=""),r.push({type:"operator",value:s}))}}else/\S/.test(s)&&(s==","?(r.push({type:"number",value:i}),i="",r.push({type:"comma",value:s})):s=="!"?(r.push({type:"number",value:i}),r.push({type:"operator",value:s}),i=""):i+=s)}return i.length&&r.push({type:"number",value:i}),r}function se(e){let t=qi(e);const r=[],i=[];for(let n=0;n<t.length;++n){let{type:s,value:a}=t[n],l=t[n+1]||{};if(s=="number")if(l.value=="("&&/[^\d.\-]/.test(a)){let u="",o=[],c=[];for(n+=1;t[n++]!==void 0;){let f=t[n];if(f===void 0)break;let m=f.value;if(m==")"){if(!o.length)break;o.pop(),u+=m}else if(m=="("&&o.push(m),m==","&&!o.length){let h=se(u);h.length&&c.push(h),u=""}else u+=m}u.length&&c.push(se(u)),i.push({type:"function",name:a,value:c})}else/[^\d.\-]/.test(a)?i.push({type:"variable",value:a}):i.push({type:"number",value:a});else if(s=="operator")if(a=="(")r.push(a);else if(a==")"){for(;r.length&&b(r)!="(";)i.push({type:"operator",value:r.pop()});r.pop()}else{for(;r.length&&it[b(r)]>=it[a];){let u=r.pop();/[()]/.test(u)||i.push({type:"operator",value:u})}r.push(a)}}for(;r.length;)i.push({type:"operator",value:r.pop()});return i}function Xi(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"%":return t%r;case"|":return t|r;case"&":return t&r;case"<":return t<r;case">":return t>r;case"^":return Math.pow(t,r);case"÷":case"/":return t/r;case"=":case"==":return t==r;case"≤":case"<=":return t<=r;case"≥":case">=":return t>=r;case"≠":case"!=":return t!=r;case"∧":case"&&":return t&&r;case"∨":case"||":return t||r;case"<<":return t<<r;case">>":return t>>r}}function Et(e,t){let[r,i,n]=e.match(/([\d.\-]+)(.*)/)||[],s=t[n];return s===void 0?s:typeof s=="number"?Number(i)*s:i*Ae(se(s),t)}function Hi(e){return e[0]==e[2]&&e[1]==e[3]}function P(e,t){const r=se(e);return Ae(r,Object.assign({},Fi,t))}class Vi{constructor(){this.cache={}}clear(){this.cache={}}set(t,r){if(x(t))return"";let i=this.getKey(t);return this.cache[i]=r}get(t){let r=this.getKey(t);return this.cache[r]}getKey(t){return Ge(typeof t=="string"?t:JSON.stringify(t))}}const D=new Vi;function ft(e,t){return(...r)=>{let i=e+r.join("-");return D.get(i)||D.set(i,t(...r))}}function pe(e,t){return{type:e,value:t}}function Zi(e){let t=String(e),r=[],i=[];if(!t.startsWith("[")||!t.endsWith("]"))return r;for(let n=1;n<t.length-1;++n){let s=t[n];if(!(s=="-"&&t[n-1]=="-")){if(s=="-"){i.push(s);continue}if(b(i)=="-"){i.pop();let a=i.pop();r.push(a?pe("range",[a,s]):pe("char",s));continue}i.length&&r.push(pe("char",i.pop())),i.push(s)}}return i.length&&r.push(pe("char",i.pop())),r}const Gi=ft("build_range",e=>{let t=Zi(e);return rr(t,({type:r,value:i})=>{if(r=="char")return i;let[n,s]=i,a=!1;n>s&&([n,s]=[s,n],a=!0);let l=rt(oi)(n,s);return a&&l.reverse(),l})});function Z(e){return(...t)=>e(...rr(t,r=>String(r).startsWith("[")?Gi(r):r))}class Yi{constructor(t){this.prev=this.next=null,this.data=t}}class Ki{constructor(t=20){this._limit=t,this._size=0}push(t){this._size>=this._limit&&(this.root=this.root.next,this.root.prev=null);let r=new Yi(t);this.root?(r.prev=this.tail,this.tail.next=r,this.tail=r):this.root=this.tail=r,this._size++}last(t=1){let r=this.tail;for(;--t&&r.prev;)r=r.prev;return r.data}}class At{constructor(t){this.p=xi(t([151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180]))}grad(t,r,i,n){let s=t&15,a=s<8?r:i,l=s<4?i:s==12||s==14?r:n;return(s&1?-a:a)+(s&2?-l:l)}noise(t,r,i){let{p:n,grad:s}=this,[a,l,u]=[t,r,i].map(_=>Math.floor(_)&255);[t,r,i]=[t,r,i].map(_=>_-Math.floor(_));let[o,c,f]=[t,r,i].map(_=>_*_*_*(_*(_*6-15)+10)),m=n[a]+l,h=n[m]+u,p=n[m+1]+u,d=n[a+1]+l,g=n[d]+u,y=n[d+1]+u;return z(f,z(c,z(o,s(n[h],t,r,i),s(n[g],t-1,r,i)),z(o,s(n[p],t,r-1,i),s(n[y],t-1,r-1,i))),z(c,z(o,s(n[h+1],t,r,i-1),s(n[g+1],t-1,r,i-1)),z(o,s(n[p+1],t,r-1,i-1),s(n[y+1],t-1,r-1,i-1))))}}function Nt(e,t){let r={},i=!0;for(let n=0;n<e.length;++n){let s=e[n],a=t[n];if(/=/.test(s)){let[l,u]=A(s,{symbol:"=",noSpace:!0});u!==void 0?(t.includes(l)&&(r[l]=u),i=!1):r[a]=s}else i&&(r[a]=s)}return r}function xe(e){let t=R(M(e)),r={},i=[],n,s=!1;for(;t.next();){let{prev:a,curr:l,next:u}=t.get();if(l.isSymbol(":")&&!n)n=Oe(i),i=[];else if(l.isSymbol(";")&&n)r[n]=Pt(n,Oe(i),s),i=[],n=null,s=!1;else if(!l.isSymbol(";")){let o=a&&a.isSymbol("-"),c=u&&u.isSymbol("-"),f=l.isSymbol("-");!n&&!i.length&&f&&!o&&!c?u&&u.isSymbol(":")?i.push(l):s=!0:i.push(l)}}return i.length&&n&&(r[n]=Pt(n,Oe(i),s)),r}function Pt(e,t,r){return["fill-rule","fill"].includes(e)?t:r?`-1 * (${t})`:t}function Oe(e){return e.map(t=>t.value).join("")}const Ji=["auto","reverse"],Qi=["deg","rad","grad","turn"];function en(e){let t=R(M(e)),r=!1,i="",n={direction:"",angle:""};for(;t.next();){let{prev:s,curr:a,next:l}=t.get();if(a.isWord()&&Ji.includes(a.value))n.direction=a.value,r=!0;else if(a.isNumber())n.angle=Number(a.value),r=!0;else if(a.isWord()&&s&&s.isNumber()&&Qi.includes(a.value))i=a.value;else if(a.isSpace()&&n.direction!==""&&n.angle!=="")break}return r||(n.direction="auto"),tn(n,i)}function tn(e,t){let{angle:r}=e;return r===""&&(r=0),t==="rad"&&(r/=Math.PI/180),t==="grad"&&(r*=.9),t==="turn"&&(r*=360),Object.assign({},e,{angle:r})}const{cos:le,sin:ae,abs:rn,atan2:gr,PI:ht}=Math,$=mi(e=>we(xe(e),{min:3,max:3600})),Ne={circle:()=>$`
    split: 180;
    scale: .99
  `,triangle:()=>$`
    rotate: 30;
    scale: 1.1;
    move: 0 .2
  `,pentagon:()=>$`
    split: 5;
    rotate: 54
  `,hexagon:()=>$`
    split: 6;
    rotate: 30;
    scale: .98
  `,octagon:()=>$`
    split: 8;
    rotat: 22.5;
    scale: .99
  `,star:()=>$`
    split: 10;
    r: cos(5t);
    rotate: -18;
    scale: .99
  `,infinity:()=>$`
    split: 180;
    scale: .99;
    x: cos(t)*.99 / (sin(t)^2 + 1);
    y: x * sin(t)
  `,heart:()=>$`
    split: 180;
    rotate: 180;
    a: cos(t)*13/18 - cos(2t)*5/18;
    b: cos(3t)/18 + cos(4t)/18;
    x: (.75 * sin(t)^3) * 1.2;
    y: (a - b + .2) * -1.1
  `,bean:()=>$`
    split: 180;
    r: sin(t)^3 + cos(t)^3;
    move: -.35 .35;
  `,bicorn:()=>$`
    split: 180;
    x: cos(t);
    y: sin(t)^2 / (2 + sin(t)) - .5
  `,drop:()=>$`
    split: 180;
    rotate: 90;
    scale: .95;
    x: sin(t);
    y: (1 + sin(t)) * cos(t) / 1.6
  `,fish:()=>$`
    split: 240;
    x: cos(t) - sin(t)^2 / sqrt(2) - .04;
    y: sin(2t)/2
  `,whale:()=>$`
    split: 240;
    rotate: 180;
    R: 3.4 * (sin(t)^2 - .5) * cos(t);
    x: cos(t) * R + .75;
    y: sin(t) * R * 1.2
  `,windmill:()=>$`
    split: 18;
    R: seq(.618, 1, 0);
    T: seq(t-.55, t, t);
    x: R * cos(T);
    y: R * sin(T)
  `,vase:()=>$`
    split: 240;
    scale: .3;
    x: sin(4t) + sin(t) * 1.4;
    y: cos(t) + cos(t) * 4.8 + .3
  `,clover:(e=3)=>(e=C(e,3,5),e==4&&(e=2),$`
      split: 240;
      r: cos(${e}t);
      scale: .98
    `),hypocycloid:(e=3)=>{e=C(e,3,5);let t=[0,0,0,.34,.25,.19][e];return $`
      split: 240;
      scale: ${t};
      k: ${e};
      x: (k-1)*cos(t) + cos((k-1)*t);
      y: (k-1)*sin(t) - sin((k-1)*t)
    `},bud:(e=3)=>(e=C(e,3,10),$`
      split: 240;
      scale: .8;
      r: 1 + .2 * cos(${e}t)
    `)};class Rt{constructor(t,r,i){this.x=t,this.y=r,this.extra=i}valueOf(){return this.x+" "+this.y}toString(){return this.valueOf()}}function nn(e,t){typeof arguments[0]=="function"&&(t=e,e={}),t||(t=p=>[le(p),ae(p)]);let r=e.split||180,i=e.turn||1,n=e.frame,s=e.fill||e["fill-rule"],a=en(e.direction||e.dir||""),l=e.unit,u=ht*2*i/r,o=[],c,f,m=e.scale===void 0?1:e.scale,h=([p,d,g=0,y=0])=>{if(p=="evenodd"||p=="nonzero")return o.push(new Rt(p,"",""));let[_,w]=Ct(p,-d,m),[k,L]=Ct(g,-y,m),V=sn(_,w,k,L,a);l!==void 0&&l!=="%"?l!=="none"&&(_+=l,w+=l):(_=(_+1)*50+"%",w=(w+1)*50+"%"),o.push(new Rt(_,w,V))};(s=="nonzero"||s=="evenodd")&&h([s,"",""]);for(let p=0;p<r;++p){let d=u*p,g=t(d,p);p||(c=g),h(g)}if(n!==void 0){h(c);let p=n/100;i>1&&(p*=2),p==0&&(p=.002);for(let d=0;d<r;++d){let g=-u*d,[y,_,w=0,k=0]=t(g,d),L=gr(_+k,y-w),V=[y-p*le(L),_-p*ae(L)];d||(f=V),h(V)}h(f),h(c)}return o}function sn(e,t,r,i,n){let s=gr(t+i,e-r)*180/ht;return n.direction==="reverse"&&(s-=180),n.direction||(s=90),n.angle&&(s+=n.angle),s}function ln(e,t,r){let i=-ht/180*r;return[e*le(i)-t*ae(i),t*le(i)+e*ae(i)]}function an(e,t,r){let[i,n=i]=A(r).map(Number);return[e+(i||0),t-(n||0),i,n]}function Ct(e,t,r){let[i,n=i]=A(r).map(Number);return[e*i,t*n]}function we(e,{min:t,max:r}){let i=C(parseInt(e.vertices||e.points||e.split)||0,t,r),n=F(e.x)?"cos(t)":e.x,s=F(e.y)?"sin(t)":e.y,a=F(e.r)?"":e.r,{unit:l,value:u}=dr(a);l&&!e[l]&&l!=="t"&&(F(e.unit)&&(e.unit=l),a=e.r=u),e.degree&&(e.rotate=e.degree),e.origin&&(e.move=e.origin);let o=Object.assign({},e,{split:i});return nn(o,(c,f)=>{let m=Object.assign({},e,{t:c,θ:c,i:f+1,seq(...y){return y.length?y[f%y.length]:""},range(y,_=0){y=Number(y)||0,_=Number(_)||0,y>_&&([y,_]=[_,y]);let w=rn(_-y)/(i-1);return y+w*f}}),h=P(n,m),p=P(s,m),d=0,g=0;if(a){let y=P(a,m);y==0&&(y=1e-5),h=y*le(c),p=y*ae(c)}return e.rotate&&([h,p]=ln(h,p,Number(e.rotate)||0)),e.move&&([h,p,d,g]=an(h,p,e.move)),[h,p,d,g]})}const un="MmLlHhVvCcSsQqTtAaZz",on="mlhvcsqtaz";function de(e){let t=R(M(e)),r={},i={commands:[],valid:!0};for(;t.next();){let{curr:n}=t.get();if(!(n.isSpace()||n.isSymbol(",")))if(n.isWord())r.name&&(i.commands.push(r),r={}),r.name=n.value,r.value=[],un.includes(n.value)?on.includes(n.value)?r.type="relative":r.type="absolute":(r.type="unknown",i.valid=!1);else if(r.value){let s=n.value;n.isNumber()&&(s=Number(n.value)),r.value.push(s)}else r.name||(i.valid=!1)}return r.name&&i.commands.push(r),i}const j={name:"cssd-uniform-time","animation-name":"cssd-uniform-time-animation","animation-duration":31536e6,"animation-iteration-count":"infinite","animation-delay":"0s","animation-direction":"normal","animation-fill-mode":"none","animation-play-state":"running","animation-timing-function":"linear"};j.animation=`
  ${j["animation-duration"]}ms
  ${j["animation-timing-function"]}
  ${j["animation-delay"]}
  ${j["animation-iteration-count"]}
  ${j["animation-name"]}
`;const _r={name:"cssd-uniform-mousex"},yr={name:"cssd-uniform-mousey"},vr={name:"cssd-uniform-width"},br={name:"cssd-uniform-height"},H=Object.freeze(Object.defineProperty({__proto__:null,uniform_height:br,uniform_mousex:_r,uniform_mousey:yr,uniform_time:j,uniform_width:vr},Symbol.toStringTag,{value:"Module"}));function Be(e){return He((t,r,...i)=>{if(!i||!r)return"";let n=E(r()),s=n;/\D/.test(n)&&!/\d+[x-]\d+/.test(n)&&(s=P(n),s===0&&(s=n));let a=Math.random();return ci(s,(...l)=>i.map(u=>E(u(...l,a))).join(",")).join(e)})}function U(e,t,r){return e[t]||(e[t]=new Ki),e[t].push(r),r}function Lt(e){return-1*e}function cn(e,t,r,i=1){let s=Math.sqrt(2/4)*i,[a,l]=[-s,s];return z((e-a)/(l-a),t*i,r*i)}const nt=Jt({i({count:e}){return t=>e},y({y:e}){return t=>e},x({x:e}){return t=>e},z({z:e}){return t=>e},I({grid:e}){return t=>e.count},Y({grid:e}){return t=>e.y},X({grid:e}){return t=>e.x},Z({grid:e}){return t=>e.z},id({x:e,y:t,z:r}){return i=>ee(e,t,r)},n({extra:e}){let t=b(e);return r=>t?t[0]+(Number(r)||0):"@n"},nx({extra:e}){let t=b(e);return r=>t?t[1]+(Number(r)||0):"@nx"},ny({extra:e}){let t=b(e);return r=>t?t[2]+(Number(r)||0):"@ny"},N({extra:e}){let t=b(e);return r=>t?t[3]+(Number(r)||0):"@N"},m:Be(","),M:Be(" "),µ:Be(""),p({context:e,pick:t}){return Z((...r)=>{r.length||(r=e.last_pick_args||[]);let i=t(r);return e.last_pick_args=r,U(e,"last_pick",i)})},P({context:e,pick:t,position:r}){let i="P-counter"+r;return Z((...n)=>{let s=!0;n.length||(n=e.last_pick_args||[],s=!1);let a=e.last_pick,l=a?a.last(1):"";if(s&&(e[i]||(e[i]={}),l=e[i].last_pick),n.length>1){let o=n.findIndex(c=>c===l);o!==-1&&n.splice(o,1)}let u=t(n);return e.last_pick_args=n,s&&(e[i].last_pick=u),U(e,"last_pick",u)})},pl({context:e,extra:t,position:r}){let i=b(t),n=i?b(i):"",s="pl-counter"+r+n;return Z((...a)=>{e[s]||(e[s]=0),e[s]+=1;let l=a.length,[u=e[s]]=i||[],o=(u-1)%l,c=a[o];return U(e,"last_pick",c)})},pr({context:e,extra:t,position:r}){let i=b(t),n=i?b(i):"",s="pr-counter"+r+n;return Z((...a)=>{e[s]||(e[s]=0),e[s]+=1;let l=a.length,[u=e[s]]=i||[],o=(u-1)%l,c=a[l-o-1];return U(e,"last_pick",c)})},pd({context:e,extra:t,position:r,shuffle:i}){let n=b(t),s=n?b(n):"",a="pd-counter"+r+s,l="pd-values"+r+s;return Z((...u)=>{e[a]||(e[a]=0),e[a]+=1,e[l]||(e[l]=i(u||[]));let o=u.length,[c=e[a]]=n||[],f=(c-1)%o,m=e[l][f];return U(e,"last_pick",m)})},lp({context:e}){return(t=1)=>{let r=e.last_pick;return r?r.last(t):""}},r({context:e,rand:t}){return(...r)=>{let n=(r.every(_t)?rt:Tt)(t)(...r);return U(e,"last_rand",n)}},rn({x:e,y:t,context:r,position:i,grid:n,extra:s,shuffle:a}){let l="noise-2d"+i,[u,o,c,f,m,h]=b(s)||[],p=u&&f;return(...d)=>{let{from:g=0,to:y=g,frequency:_=1,amplitude:w=1}=Nt(d,["from","to","frequency","amplitude"]);d.length==1&&([g,y]=[0,g]),r[l]||(r[l]=new At(a)),_=C(_,0,1/0),w=C(w,0,1/0);let k=[g,y].every(_t)?rt:Tt,L=p?r[l].noise((o-1)/m*_,(c-1)/h*_,0):r[l].noise((e-1)/n.x*_,(t-1)/n.y*_,0),Pr=k((Rr,Cr)=>cn(L*w,Rr,Cr,w))(g,y);return U(r,"last_rand",Pr)}},lr({context:e}){return(t=1)=>{let r=e.last_rand;return r?r.last(t):""}},noise({context:e,grid:t,position:r,shuffle:i,...n}){let s={i:n.count,I:t.count,x:n.x,X:t.x,y:n.y,Y:t.y,z:n.z,Z:t.z};return(a,l,u=0)=>{let o="raw-noise-2d"+r;return e[o]||(e[o]=new At(i)),e[o].noise(P(a,s),P(l,s),P(u,s))}},stripe(){return(...e)=>{let t=e.map(E),r=t.length,i=0,n=[],s;if(!r)return"";t.forEach(l=>{let[u,o]=A(l);o!==void 0?n.push(o):i+=1});let a=n.length?`(100% - ${n.join(" - ")}) / ${i}`:`100% / ${r}`;return t.map((l,u)=>{if(n.length){let[o,c]=A(l);return s=(s?s+" + ":"")+(c!==void 0?c:a),`${o} 0 calc(${s})`}return`${l} 0 ${100/r*(u+1)}%`}).join(",")}},calc(){return e=>P(E(e))},hex(){return e=>parseInt(E(e)).toString(16)},svg:He((e,...t)=>{let r=t.map(n=>E(n())).join(",");if(!r.startsWith("<")){let n=Ke(r);r=jt(n)}let i=St(r);return $t(i)}),filter:He((e,...t)=>{let r=t.map(a=>E(a())),i=r.join(","),n=K("filter-");if(r.every(a=>/^[\d.]/.test(a)||/^(\w+)/.test(a)&&!/[{}<>]/.test(a))){let{frequency:a,scale:l=1,octave:u,seed:o=e.seed,blur:c,erode:f,dilate:m}=Nt(r,["frequency","scale","octave","seed","blur","erode","dilate"]);if(i=`
        x: -20%;
        y: -20%;
        width: 140%;
        height: 140%;
      `,x(m)||(i+=`
          feMorphology {
            operator: dilate;
            radius: ${m};
          }
        `),x(f)||(i+=`
          feMorphology {
            operator: erode;
            radius: ${f};
          }
        `),x(c)||(i+=`
          feGaussianBlur {
            stdDeviation: ${c};
          }
        `),!x(a)){let[h,p=h]=A(a);u=u?`numOctaves: ${u};`:"",i+=`
          feTurbulence {
            type: fractalNoise;
            baseFrequency: ${h} ${p};
            seed: ${o};
            ${u}
          }
          feDisplacementMap {
            in: SourceGraphic;
            scale: ${l};
          }
        `}}if(!i.startsWith("<")){let a=Ke(i,{type:"block",name:"filter"});i=jt(a)}let s=St(i).replace(/<filter([\s>])/,`<filter id="${n}"$1`);return $t(s,n)}),var(){return e=>`var(${E(e)})`},ut(){return e=>`var(--${j.name})`},uw(){return e=>`var(--${vr.name})`},uh(){return e=>`var(--${br.name})`},ux(){return e=>`var(--${_r.name})`},uy(){return e=>`var(--${yr.name})`},plot({count:e,context:t,extra:r,position:i,grid:n}){let s="offset-points"+i,a=b(r);return l=>{let[u=e,o,c,f=n.count]=a||[];if(!t[s]){let m=xe(l);delete m.fill,delete m["fill-rule"],delete m.frame,m.points=f,t[s]=we(m,{min:1,max:65536})}return t[s][u-1]}},Plot({count:e,context:t,extra:r,position:i,grid:n}){let s="Offset-points"+i,a=b(r);return l=>{let[u=e,o,c,f=n.count]=a||[];if(!t[s]){let m=xe(l);delete m.fill,delete m["fill-rule"],delete m.frame,m.points=f,m.unit=m.unit||"none",t[s]=we(m,{min:1,max:65536})}return t[s][u-1]}},shape(){return ft("shape-function",(e="",...t)=>{e=String(e).trim();let r=[];if(e.length)if(typeof Ne[e]=="function")r=Ne[e](t);else{let i=e,n=t.join(",");n.length&&(i=e+","+n);let s=xe(i);r=we(s,{min:3,max:3600})}return`polygon(${r.join(",")})`})},doodle(){return e=>e},shaders(){return e=>e},canvas(){return e=>e},pattern(){return e=>e},invert(){return e=>{let t=de(e);return t.valid?t.commands.map(({name:r,value:i})=>{switch(r){case"v":return"h"+i.join(" ");case"V":return"H"+i.join(" ");case"h":return"v"+i.join(" ");case"H":return"V"+i.join(" ");default:return r+i.join(" ")}}).join(" "):e}},flipH(){return e=>{let t=de(e);return t.valid?t.commands.map(({name:r,value:i})=>{switch(r){case"h":case"H":return r+i.map(Lt).join(" ");default:return r+i.join(" ")}}).join(" "):e}},flipV(){return e=>{let t=de(e);return t.valid?t.commands.map(({name:r,value:i})=>{switch(r){case"v":case"V":return r+i.map(Lt).join(" ");default:return r+i.join(" ")}}).join(" "):e}},flip(...e){let t=nt.flipH(...e),r=nt.flipV(...e);return i=>r(t(i))},reverse(...e){return t=>{let r=de(t);return r.valid?r.commands.reverse().map(({name:i,value:n})=>i+n.join(" ")).join(" "):t}},cycle(){return e=>{let t=A(e,{symbol:" "}),r=t.length-1,i=[t.join(" ")];for(let n=0;n<r;++n){let s=t.pop();t.unshift(s),i.push(t.join(" "))}return i}}},{index:"i",col:"x",row:"y",depth:"z",rand:"r",pick:"p",pn:"pl",pnr:"pr",stripes:"stripe",strip:"stripe",patern:"pattern",flipv:"flipV",fliph:"flipH",t:"ut","svg-filter":"filter","last-rand":"lr","last-pick":"lp",multiple:"m",multi:"m",rep:"µ",repeat:"µ",ms:"M",s:"I",size:"I",sx:"X","size-x":"X","size-col":"X","max-col":"X",sy:"Y","size-y":"Y","size-row":"Y","max-row":"Y",sz:"Z","size-z":"Z","size-depth":"Z","pick-by-turn":"pl","pick-n":"pl","pick-d":"pd",offset:"plot",Offset:"Plot",point:"plot",Point:"Plot",paint:"canvas"}),xr={"4a0":[1682,2378],"2a0":[1189,1682],a0:[841,1189],a1:[594,841],a2:[420,594],a3:[297,420],a4:[210,297],a5:[148,210],a6:[105,148],a7:[74,105],a8:[52,74],a9:[37,52],a10:[26,37],b0:[1e3,1414],b1:[707,1e3],b2:[500,707],b3:[353,500],b4:[250,353],b5:[176,250],b6:[125,176],b7:[88,125],b8:[62,88],b9:[44,62],b10:[31,44],b11:[22,32],b12:[16,22],c0:[917,1297],c1:[648,917],c2:[458,648],c3:[324,458],c4:[229,324],c5:[162,229],c6:[114,162],c7:[81,114],c8:[57,81],c9:[40,57],c10:[28,40],c11:[22,32],c12:[16,22],d0:[764,1064],d1:[532,760],d2:[380,528],d3:[264,376],d4:[188,260],d5:[130,184],d6:[92,126],letter:[216,279],postcard:[100,148],poster:[390,540]},fn={portrait:"p",pt:"p",p:"p",landscape:"l",ls:"l",l:"l"},hn="mm";function mn(e,t){e=String(e).toLowerCase();let[r,i]=xr[e]||[];return fn[t]=="p"&&([i,r]=[r,i]),[i,r].map(n=>n+hn)}function pn(e){return!!xr[e]}let ge=[];function wr(e){if(!ge.length){let t=new Set;if(typeof document<"u")for(let r in document.head.style)r.startsWith("-")||t.add(r.replace(/[A-Z]/g,"-$&").toLowerCase());t.has("grid-gap")||t.add("grid-gap"),ge=Array.from(t)}return e instanceof RegExp?ge.filter(t=>e.test(t)):ge}function $r(e){let t=new RegExp(`\\-?${e}\\-?`);return wr(t).map(r=>r.replace(t,"")).reduce((r,i)=>(r[i]=i,r),{})}const dn=$r("webkit"),gn=$r("moz");function Sr(e,t){return dn[e]?`-webkit-${t} ${t}`:gn[e]?`-moz-${t} ${t}`:t}const _n={center:"50%",left:"0%",right:"100%",top:"50%",bottom:"50%"},yn={center:"50%",top:"0%",bottom:"100%",left:"50%",right:"50%"},_e=Jt({size(e,{is_special_selector:t,grid:r}){let[i,n=i]=A(e);pn(i)&&([i,n]=mn(i,n));let s=`
      width: ${i};
      height: ${n};
    `;return t?(i==="auto"||n==="auto")&&(s+=`aspect-ratio: ${r.ratio};`):s+=`
        --internal-cell-width: ${i};
        --internal-cell-height: ${n};
      `,s},place(e,{extra:t}){let[r,i="50%"]=A(e);r=_n[r]||r,i=yn[i]||i;const n="var(--internal-cell-width, 25%)",s="var(--internal-cell-height, 25%)";return`
      position: absolute;
      left: ${r};
      top: ${i};
      width: ${n};
      height: ${s};
      margin-left: calc(${n} / -2);
      margin-top: calc(${s} / -2);
      grid-area: unset;
      --plot-angle: ${t||0};
      rotate: ${t||0}deg;
    `},grid(e,t){let[r,i]=A(e,{symbol:"/",noSpace:!0});return{grid:et(r,t.max_grid),size:i?this.size(i,t):""}},seed(e){return e},shape:ft("shape-property",e=>{let[t,...r]=A(e);if(typeof Ne[t]!="function")return"";let i="clip-path",n=Ne[t](...r),s=`${i}: polygon(${n.join(",")});`;return Sr(i,s)+"overflow: hidden;"}),use(e){if(e.length>2)return e}},{"place-cell":"place",offset:"place",position:"place"}),O={even:e=>!(e%2),odd:e=>!!(e%2)};function We(e,t,r){for(let i=0;i<=r;++i)if(P(e,{n:i})==t)return!0}const vn={at({x:e,y:t}){return(r,i)=>e==r&&t==i},nth({count:e,grid:t}){return(...r)=>r.some(i=>O[i]?O[i](e):We(i,e,t.count))},row({y:e,grid:t}){return(...r)=>r.some(i=>O[i]?O[i](e):We(i,e,t.y))},col({x:e,grid:t}){return(...r)=>r.some(i=>O[i]?O[i](e):We(i,e,t.x))},even({count:e,grid:t,x:r,y:i}){return n=>O.odd(r+i)},odd({count:e,grid:t,x:r,y:i}){return n=>O.even(r+i)},random({random:e,count:t,x:r,y:i,grid:n}){return(s=.5)=>/\D/.test(s)?e()<P("("+s+")",{x:r,X:n.x,y:i,Y:n.y,i:t,I:n.count,random:e}):e()<s},match({count:e,grid:t,x:r,y:i,random:n}){return s=>!!P("("+s+")",{x:r,X:t.x,y:i,Y:t.y,i:e,I:t.count,random:n})}};var G=globalThis,ue=Math,Pe=[],I=256,kr=6,bn=52,xn="random",wn=ue.pow(I,kr),jr=ue.pow(2,bn),$n=jr*2,q=I-1,zt;function ye(e,t,r){var i=[];t=t==!0?{entropy:!0}:t||{};var n=st(Tr(t.entropy?[e,oe(Pe)]:e??kn(),3),i),s=new Sn(i),a=function(){for(var l=s.g(kr),u=wn,o=0;l<jr;)l=(l+o)*I,u*=I,o=s.g(1);for(;l>=$n;)l/=2,u/=2,o>>>=1;return(l+o)/u};return a.int32=function(){return s.g(4)|0},a.quick=function(){return s.g(4)/4294967296},a.double=a,st(oe(s.S),Pe),(t.pass||r||function(l,u,o,c){return c&&(c.S&&It(c,s),l.state=function(){return It(s,{})}),o?(ue[xn]=l,u):l})(a,n,"global"in t?t.global:this==ue,t.state)}function Sn(e){var t,r=e.length,i=this,n=0,s=i.i=i.j=0,a=i.S=[];for(r||(e=[r++]);n<I;)a[n]=n++;for(n=0;n<I;n++)a[n]=a[s=q&s+e[n%r]+(t=a[n])],a[s]=t;(i.g=function(l){for(var u,o=0,c=i.i,f=i.j,m=i.S;l--;)u=m[c=q&c+1],o=o*I+m[q&(m[c]=m[f=q&f+u])+(m[f]=u)];return i.i=c,i.j=f,o})(I)}function It(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function Tr(e,t){var r=[],i=typeof e,n;if(t&&i=="object")for(n in e)try{r.push(Tr(e[n],t-1))}catch{}return r.length?r:i=="string"?e:e+"\0"}function st(e,t){for(var r=e+"",i,n=0;n<r.length;)t[q&n]=q&(i^=t[q&n]*19)+r.charCodeAt(n++);return oe(t)}function kn(){try{var e;return zt&&(e=zt.randomBytes)||(e=new Uint8Array(I),(G.crypto||G.msCrypto).getRandomValues(e)),oe(e)}catch{var t=G.navigator,r=t&&t.plugins;return[+new Date,G,r,G.screen,oe(Pe)]}}function oe(e){return String.fromCharCode.apply(0,e)}st(ue.random(),Pe);function W(e){return/^\:(host|doodle)/.test(e)}function lt(e){return/^\:(container|parent)/.test(e)}function De(e){return W(e)||lt(e)}const Er={};for(let e of Object.getOwnPropertyNames(Math))Er[e]=()=>(...t)=>typeof Math[e]=="number"?Math[e]:(t=t.map(r=>P(E(r))),Math[e](...t));class jn{constructor(t){this.tokens=t,this.rules={},this.props={},this.keyframes={},this.grid=null,this.seed=null,this.is_grid_defined=!1,this.coords=[],this.doodles={},this.canvas={},this.pattern={},this.shaders={},this.reset(),this.custom_properties={},this.uniforms={}}reset(){this.styles={host:"",container:"",cells:"",keyframes:""},this.coords=[],this.doodles={},this.canvas={},this.pattern={},this.shaders={};for(let t in this.rules)t.startsWith("#c")&&delete this.rules[t]}add_rule(t,r){let i=this.rules[t];i||(i=this.rules[t]=[]),i.push.apply(i,fe(r))}pick_func(t){return nt[t]||Er[t]}apply_func(t,r,i){let n=t(...fe(r)),s=[];return i.forEach(l=>{let u=typeof l.value,o=u==="number"||u==="string";if(!l.cluster&&o)s.push(...A(l.value,{noSpace:!0}));else if(typeof l=="function")s.push(l);else if(!x(l.value)){let c=E(l.value);s.push(c)}}),s=wi(s),n(...fe(s))}compose_aname(...t){return t.join("-")}compose_selector({x:t,y:r,z:i},n=""){return`#${ee(t,r,i)}${n}`}is_composable(t){return["doodle","shaders","canvas","pattern"].includes(t)}read_var(t,r){let i=r.count,n=Object.assign({},this.custom_properties.host,this.custom_properties.container,this.custom_properties[i]);if(n[t]!==void 0){let s=String(n[t]).trim();return s[0]=="("&&s[s.length-1]===")"&&(s=s.substring(1,s.length-1)),s.replace(/;+$/g,"")}return t}compose_argument(t,r,i=[],n){r.extra||(r.extra=[]),r.extra.push(i);let s=t.map(a=>{if(a.type==="text")return/^\-\-\w/.test(a.value)?n&&n.name==="@var"?a.value:this.read_var(a.value,r):a.value;if(a.type==="func"){let l=a.name.substr(1),u=this.pick_func(l);if(typeof u=="function"){if(this.check_uniforms(l),this.is_composable(l)){let f=E((a.arguments[0]||[])[0]);if(!x(f))switch(l){case"doodle":return this.compose_doodle(this.inject_variables(f,r.count));case"shaders":return this.compose_shaders(f,r);case"canvas":return this.compose_canvas(f,a.arguments.slice(1));case"pattern":return this.compose_pattern(f,r)}}r.position=a.position;let o=a.arguments.map(f=>u.lazy?(...m)=>this.compose_argument(f,r,m,a):this.compose_argument(f,r,i,a));return this.apply_func(u,r,o)}else return a.name}});return r.extra.pop(),{cluster:t.cluster,value:s.length>=2?{value:s.join("")}:s[0]}}compose_doodle(t){let r=K("doodle");return this.doodles[r]=t,"${"+r+"}"}compose_shaders(t,{x:r,y:i,z:n}){let s=K("shader");return this.shaders[s]={id:"--"+s,shader:t,cell:ee(r,i,n)},"${"+s+"}"}compose_pattern(t,{x:r,y:i,z:n}){let s=K("pattern");return this.pattern[s]={id:"--"+s,code:t,cell:ee(r,i,n)},"${"+s+"}"}compose_canvas(t,r=[]){let i=t,n=r.map(a=>E(a[0])).join(",");n.length&&(i=t+","+n);let s=K("canvas");return this.canvas[s]={code:i},"${"+s+"}"}check_uniforms(t){switch(t){case"ut":case"t":this.uniforms.time=!0;break;case"ux":this.uniforms.mousex=!0;break;case"uy":this.uniforms.mousey=!0;break;case"uw":this.uniforms.width=!0;break;case"uh":this.uniforms.height=!0;break}}inject_variables(t,r){let i=Object.assign({},this.custom_properties.host,this.custom_properties.container,this.custom_properties[r]),n=[];for(let[s,a]of Object.entries(i))n.push(`${s}: ${a};`);return n=n.join(""),n.length?`:doodle { ${n} }`+t:t}compose_value(t,r){if(!Array.isArray(t))return{value:"",extra:""};let i="";return{value:t.reduce((s,a)=>{switch(a.type){case"text":{s+=a.value;break}case"func":{let l=a.name.substr(1),u=this.pick_func(l);if(typeof u=="function")if(this.check_uniforms(l),this.is_composable(l)){let o=E((a.arguments[0]||[])[0]);if(!x(o))switch(l){case"doodle":s+=this.compose_doodle(this.inject_variables(o,r.count));break;case"shaders":s+=this.compose_shaders(o,r);break;case"pattern":s+=this.compose_pattern(o,r);break;case"canvas":s+=this.compose_canvas(o,a.arguments.slice(1));break}}else{r.position=a.position;let o=a.arguments.map(f=>u.lazy?(...m)=>this.compose_argument(f,r,m,a):this.compose_argument(f,r,[],a)),c=this.apply_func(u,r,o);x(c)||(s+=c,c.extra&&(i=c.extra))}else s+=a.name}}return s},""),extra:i}}compose_rule(t,r,i){let n=Object.assign({},r),s=t.property,a;if(s==="@seed")return"";let l=t.value.reduce((f,m)=>{let h=this.compose_value(m,n);return h&&(h.value&&f.push(h.value),h.extra&&(a=h.extra)),f},[]),u=l.join(", ");if(/^animation(\-name)?$/.test(s)){if(this.props.has_animation=!0,W(i)){let f=j[s];f&&u&&(u=f+","+u)}if(n.count>1){let{count:f}=n;switch(s){case"animation-name":{u=l.map(m=>this.compose_aname(m,f)).join(", ");break}case"animation":u=l.map(m=>{let h=(m||"").split(/\s+/);return h[0]=this.compose_aname(h[0],f),h.join(" ")}).join(", ")}}}s==="content"&&(/["']|^none$|^(var|counter|counters|attr|url)\(/.test(u)||(u=`'${u}'`)),s==="transition"&&(this.props.has_transition=!0);let o=`${s}: ${u};`;if(o=Sr(s,o),s==="clip-path"&&(o+=";overflow: hidden;"),(s==="width"||s==="height")&&(De(i)||(o+=`--internal-cell-${s}: ${u};`)),/^(background|background\-image)$/.test(s)&&/\$\{(canvas|shader|pattern)/.test(u)&&(o+="background-size: 100% 100%;"),/^\-\-/.test(s)){let f=r.count;lt(i)&&(f="container"),W(i)&&(f="host"),this.custom_properties[f]||(this.custom_properties[f]={}),this.custom_properties[f][s]=u}if(/^@/.test(s)&&_e[s.substr(1)]){let f=s.substr(1),m=_e[f](u,{is_special_selector:De(i),grid:n.grid,max_grid:n.max_grid,extra:a});switch(f){case"grid":{W(i)?o=m.size||"":(o="",this.is_grid_defined||(m=_e[f](u,{is_special_selector:!0,grid:n.grid,max_grid:n.max_grid}),this.add_rule(":host",m.size||""))),this.grid=n.grid,this.is_grid_defined=!0;break}case"seed":{o="";break}case"place-cell":case"place":case"position":case"offset":{W(i)||(o=m);break}case"use":{t.value.length&&this.compose(n,t.value),o="";break}default:o=m}}return o}get_raw_value(t){let r=t.raw();x(r)&&(r="");let[i,...n]=r.split(t.property);return n=n.join(t.property).replace(/^\s*:\s*/,"").replace(/[;}<]$/,"").trim().replace(/[;}<]$/,""),n}pre_compose_rule(t,r){let i=Object.assign({},r),n=t.property;switch(n){case"@grid":{let a=t.value.reduce((o,c)=>{let f=this.compose_value(c,i);return f&&f.value&&o.push(f.value),o},[]).join(", "),l=n.substr(1),u=_e[l](a,{max_grid:r.max_grid});this.grid=u.grid;break}case"@use":{t.value.length&&this.pre_compose(i,t.value);break}}}pre_compose(t,r){x(this.seed)&&((r||this.tokens).forEach(i=>{if(i.type==="rule"&&i.property==="@seed"&&(this.seed=this.get_raw_value(i)),i.type==="pseudo"&&W(i.selector))for(let n of fe(i.styles))n.type==="rule"&&n.property==="@seed"&&(this.seed=this.get_raw_value(n))}),x(this.seed)||t.update_random(this.seed)),(r||this.tokens).forEach(i=>{switch(i.type){case"rule":{this.pre_compose_rule(i,t);break}case"pseudo":{W(i.selector)&&(i.styles||[]).forEach(n=>{this.pre_compose_rule(n,t)});break}}})}compose(t,r,i){this.coords.push(t),(r||this.tokens).forEach((n,s)=>{if(n.skip||i&&this.grid)return!1;switch(n.type){case"rule":{this.add_rule(this.compose_selector(t),this.compose_rule(n,t));break}case"pseudo":{n.selector.startsWith(":doodle")&&(n.selector=n.selector.replace(/^\:+doodle/,":host"));let a=De(n.selector);a&&(n.skip=!0),n.selector.split(",").forEach(l=>{let u=n.styles.map(c=>this.compose_rule(c,t,l)),o=a?l:this.compose_selector(t,l);this.add_rule(o,u)});break}case"cond":{let a=vn[n.name.substr(1)];if(a){let l=n.arguments.map(o=>this.compose_argument(o,t));this.apply_func(a,t,l)&&this.compose(t,n.styles)}break}case"keyframes":this.keyframes[n.name]||(this.keyframes[n.name]=a=>`
              ${he(n.steps.map(l=>`
                ${l.name} {
                  ${he(l.styles.map(u=>this.compose_rule(u,a)))}
                }
              `))}
            `)}})}output(){for(let[t,r]of Object.entries(this.rules))if(lt(t))this.styles.container+=`
          .container {
            ${he(r)}
          }
        `;else{let i=W(t)?"host":"cells",n=he(r).trim(),s=i==="host"?`${t}, .host`:t;this.styles[i]+=`${s} { ${n} }`}return this.uniforms.time&&(this.styles.container+=`
        :host, .host {
          animation: ${j.animation};
        }
      `,this.styles.keyframes+=`
       @keyframes ${j["animation-name"]} {
         from { --${j.name}: 0 }
         to { --${j.name}: ${j["animation-duration"]/10} }
       }
      `),this.coords.forEach((t,r)=>{for(let[i,n]of Object.entries(this.keyframes)){let s=this.compose_aname(i,t.count);this.styles.keyframes+=`
          ${ui(r===0,`@keyframes ${i} { ${n(t)} }`)}
          @keyframes ${s} {
            ${n(t)}
          }
        `}}),{props:this.props,styles:this.styles,grid:this.grid,seed:this.seed,random:this.random,doodles:this.doodles,shaders:this.shaders,canvas:this.canvas,pattern:this.pattern,uniforms:this.uniforms}}}function Mt(e,t,r,i,n){let s=new jn(e),a=n||ye(String(r)),l={};function u(p){a=ye(String(p))}function o(p=0,d){return arguments.length==1&&([p,d]=[0,p]),z(a(),p,d)}function c(...p){let d=p.reduce((g,y)=>g.concat(y),[]);return d[~~(a()*d.length)]}function f(p){let d=[...p],g=p.length;for(;g;){let y=~~(a()*g--),_=d[g];d[g]=d[y],d[y]=_}return d}s.pre_compose({x:1,y:1,z:1,count:1,context:{},grid:{x:1,y:1,z:1,count:1},random:a,rand:o,pick:c,shuffle:f,max_grid:i,update_random:u});let{grid:m,seed:h}=s.output();if(m&&(t=m),h?(h=String(h),a=ye(h)):h=r,x(h)&&(h=Date.now(),a=ye(h)),h=String(h),s.seed=h,s.random=a,s.reset(),t.z==1)for(let p=1,d=0;p<=t.y;++p)for(let g=1;g<=t.x;++g)s.compose({x:g,y:p,z:1,count:++d,grid:t,context:l,rand:o,pick:c,shuffle:f,random:a,seed:h,max_grid:i});else for(let p=1,d=0;p<=t.z;++p)s.compose({x:1,y:1,z:p,count:++d,grid:t,context:l,rand:o,pick:c,shuffle:f,random:a,seed:h,max_grid:i});return s.output()}function Ot(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function Tn(e,t,r){let i=Ot(e,e.VERTEX_SHADER,t),n=Ot(e,e.FRAGMENT_SHADER,r),s=e.createProgram();return e.attachShader(s,i),e.attachShader(s,n),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)||(console.warn("Link failed: "+e.getProgramInfoLog(s)),console.warn("vs info-log: "+e.getShaderInfoLog(i)),console.warn("fs info-log: "+e.getShaderInfoLog(n))),s}function X(e,t){return e.includes(t)?e:t+`
`+e}const En=`#version 300 es
  precision highp float;
  out vec4 FragColor;
`,An=`#version 300 es
  in vec4 position;
  void main() {
    gl_Position = position;
  }
`;function Nn(e,t,r){const i=e.createTexture();e.activeTexture(e["TEXTURE"+r]),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)}function Bt(e,t,r,i){let n=D.get(e);if(n)return Promise.resolve(n);let s=document.createElement("canvas"),a=window.devicePixelRatio||1;t*=a,r*=a,s.width=t,s.height=r;let l=s.getContext("webgl2",{preserveDrawingBuffer:!0});if(!l)return Promise.resolve("");let u=X(e.fragment||"","uniform vec2 u_resolution;");u=X(u,"uniform float u_time;"),u=X(u,"uniform float u_timeDelta;"),u=X(u,"uniform int u_frameIndex;"),u=X(u,"uniform vec2 u_seed;"),e.textures.forEach(w=>{let k=`uniform sampler2D ${w.name};`;u=X(u,k)}),/(^|[^\w\_])void\s+mainImage\(\s*out\s+vec4\s+fragColor,\s*in\s+vec2\s+fragCoord\s*\)/mg.test(u)&&(u=`// https://www.shadertoy.com/howto

#define iResolution vec3(u_resolution, 0)
#define iTime u_time
#define iTimeDelta u_timeDelta
#define iFrame u_frameIndex

${e.textures.map((w,k)=>`#define iChannel${k} ${w.name}`).join(`
`)}

${u}

void main() {
  mainImage(FragColor, gl_FragCoord.xy);
}`);let c=Tn(l,e.vertex||An,En+u),f=l.getAttribLocation(c,"position"),m=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,m);let h=[-1,-1,-1,1,1,-1,1,1,-1,1,1,-1];l.bufferData(l.ARRAY_BUFFER,new Float32Array(h),l.STATIC_DRAW),l.enableVertexAttribArray(f),l.vertexAttribPointer(f,2,l.FLOAT,!1,0,0),l.viewport(0,0,l.drawingBufferWidth,l.drawingBufferHeight),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT),l.useProgram(c);const p=l.getUniformLocation(c,"u_resolution");l.uniform2fv(p,[t,r]),e.textures.forEach((w,k)=>{Nn(l,w.value,k),l.uniform1i(l.getUniformLocation(c,w.name),k)});const d=l.getUniformLocation(c,"u_seed");d&&l.uniform2f(d,Ge(i)/1e16,Math.random());const g=l.getUniformLocation(c,"u_time"),y=l.getUniformLocation(c,"u_frameIndex"),_=l.getUniformLocation(c,"u_timeDelta");if(g||_||y){let w=0,k=0;return Promise.resolve(D.set(e,L=>(l.clear(l.COLOR_BUFFER_BIT),g&&l.uniform1f(g,L/1e3),y&&l.uniform1i(y,w++),_&&(l.uniform1f(_,(k-L)/1e3),k=L),l.drawArrays(l.TRIANGLES,0,6),s.toDataURL())))}else return l.drawArrays(l.TRIANGLES,0,6),Promise.resolve(D.set(e,s.toDataURL()))}function Pn(e,t){let r=[];for(;e.next();){let{curr:i,next:n}=e.get(),s=!n||i.isSymbol(";")||n.isSymbol("}");if(r.push(i),s)break}return r.length&&(t.value=at(r)),t}function Ar(e,t){let r=[],i=[],n=t&&t.type||"",s=[];for(;e.next();){let{prev:a,curr:l,next:u}=e.get(),o=!u||l.isSymbol("}");if(n==="block"&&o){!u&&r.length&&!l.isSymbol("}")&&(r[r.length-1].value+=";"+l.value),t.value=r;break}else if(l.isSymbol("{")&&i.length&&!s.length){let c=Rn(i);if(!c.length)continue;let f=Ar(e,{type:"block",name:"unkown",value:[]});c.forEach(m=>{let h=Object.assign({},f,{name:m.name,args:m.args});r.push(h)}),i=[]}else if(l.isSymbol(":")&&i.length&&!s.length){let c=at(i);r.push(Pn(e,{type:"statement",name:c,value:""})),n=="block"&&(t.value=r),i=[]}else l.isSymbol(";")?r.length&&i.length&&(r[r.length-1].value+=";"+at(i),i=[]):(l.isSymbol("(")&&s.push(l),l.isSymbol(")")&&s.pop(),i.push(l))}return r.length&&n=="block"&&(t.value=r),n?t:r}function at(e){return e.filter((t,r)=>!(t.isSymbol(";")&&r===e.length-1)).map(t=>t.value).join("")}function Rn(e){let t=R(e),r=[],i="",n=[],s=[],a=[];for(;t.next();){let{curr:l,next:u}=t.get();!i.length&&l.isWord()?i=l.value:l.isSymbol("(")?(a.length&&s.push(l.value),a.push(l)):l.isSymbol(")")?(a.pop(),a.length?s.push(l.value):s.length&&(n.push(s.join("")),s=[])):l.isSymbol(",")?a.length?(n.push(s.join("")),s=[]):(s.length&&(n.push(s.join("")),s=[]),i&&(r.push({name:i,args:n}),i="",n=[],s=[])):s.push(l.value)}return i&&r.push({name:i,args:n}),r.filter((l,u,o)=>o.findIndex(f=>f.name===l.name&&l.args.join("")==f.args.join(""))===u)}function Cn(e){let t=R(M(e));return Ar(t)}function Ln(e,t){return`
    vec3 mapping(vec2 uv, vec2 grid) {
      vec2 _grid = 1.0/grid;
      float x = ceil(uv.x/_grid.x);
      float y = ceil(grid.y - uv.y/_grid.y);
      float i = x + (y - 1.0) * y;
      return vec3(x, y, i);
    }
    vec4 getColor(float x, float y, float i, float I, float X, float Y, float t) {
      vec4 color = vec4(0, 0, 0, 0);
      ${e}
      return color;
    }
    void main() {
      vec2 uv = gl_FragCoord.xy/u_resolution.xy;
      vec2 grid = vec2(${t.x}, ${t.y});
      vec3 p = mapping(uv, grid);
      FragColor = getColor(p.x, p.y, p.z, grid.x * grid.y, grid.x, grid.y, u_time);
    }
  `}function Nr(e,t){if(e.name==="fill"){let{r,g:i,b:n,a:s}=t.get_rgba_color(e.value);return{type:"statement",value:`
color = vec4(${ve(r/255)}, ${ve(i/255)}, ${ve(n/255)}, ${ve(s)});
`}}return e.name=="grid"?{type:"grid",value:e.value}:{type:"statement",value:""}}function zn(e,t){if(e.name==="match"){let r=e.args[0],i=[];return e.value.forEach(n=>{let s=Nr(n,t);s.type=="statement"&&i.push(s.value)}),`
      if (${r}) {
        ${i.join("")}
      }
    `}return""}function ve(e){return String(e).includes(".")?e:e+".0"}function In(e){let[t,r=t]=(e+"").replace(/\s+/g,"").replace(/[,，xX]+/g,"x").split("x").map(i=>parseInt(i));return(!t||t<1)&&(t=1),(!r||r<1)&&(r=1),{x:t,y:r}}function Mn(e,t){let r=Cn(e),i=[],n={x:1,y:1};return r.forEach(s=>{if(s.type==="statement"){let a=Nr(s,t);a.type=="statement"&&i.push(a.value),a.type==="grid"&&(n=In(a.value))}else s.type==="block"&&i.push(zn(s,t))}),Ln(i.join(""),n)}const On=er();function Bn(e){let t=D.get(e);if(t)return Promise.resolve(t);let r=On("css-doodle-paint"),i=Wn(r,e),n=new Blob([i],{type:"text/javascript"});try{CSS.paintWorklet&&CSS.paintWorklet.addModule(URL.createObjectURL(n))}catch{}return Promise.resolve(D.set(e,`paint(${r})`))}function Wn(e,t){return t=Ze(t),t.includes("paint(")||(t=`
      paint(ctx, {width, height}, props) {
        ${t}
      }
    `),`
    registerPaint('${e}', class {
      ${t}
    })
  `}function Dn(e,t,r,i){return new Promise((n,s)=>{let a=`data:image/svg+xml;utf8,${encodeURIComponent(e)}`;function l(){let u=new Image;u.crossOrigin="anonymous",u.src=a,u.onload=()=>{let o=document.createElement("canvas"),c=o.getContext("2d"),f=window.devicePixelRatio||1;i!=1&&(f=1),o.width=t*f,o.height=r*f,c.drawImage(u,0,0,o.width,o.height);try{o.toBlob(m=>{n({blob:m,source:a,url:URL.createObjectURL(m)})})}catch(m){s(m)}}}Ve()?Qt(a,l,200):l()})}function Un(e){if(typeof getComputedStyle>"u")return"";let t={};if(e.computedStyleMap)for(let[r,i]of e.computedStyleMap())r.startsWith("--")&&(t[r]=i[0][0]);else{let r=getComputedStyle(e);for(let i of r)i.startsWith("--")&&(t[i]=r.getPropertyValue(i))}return qn(t)}function Fn(e,t){return typeof getComputedStyle>"u"?"":getComputedStyle(e).getPropertyValue(t).trim().replace(/^\(|\)$/g,"")}function qn(e){let t=[];for(let[r,i]of Object.entries(e))t.push(r+":"+i);return t.join(";")}function Xn(e){let[t,r,i,n=1]=e.replace(/rgba?\((.+)\)/,(s,a)=>a).split(/,\s*/);return{r:t,g:r,b:i,a:n}}function Hn(e,t){let r=e.querySelector("#defs");return r?(r.style.color=t,Xn(getComputedStyle(r).color)):{r:0,g:0,b:0,a:1}}const Wt=1e3/60,Dt=1e3/1;function Vn(e){let t,r=0,i=0,n=0,s=!1;function a(l){r||(r=l),e(r);let u=l-i;u<Wt&&(u=Wt),u>Dt&&(u=n||Dt),i&&(r+=u),n=u,i=l,t=requestAnimationFrame(a)}return t=requestAnimationFrame(a),{resume(){t&&s&&(s=!1,t=requestAnimationFrame(a))},pause(){t&&(cancelAnimationFrame(t),s=!0)},cancel(){t&&(s=!1,cancelAnimationFrame(t),t=null)}}}if(typeof customElements<"u"){class e extends HTMLElement{constructor(){super(),this.doodle=this.attachShadow({mode:"open"}),this.animations=[],this.extra={get_variable:r=>Fn(this,r),get_rgba_color:r=>Hn(this.shadowRoot,r)}}connectedCallback(r){this.innerHTML?this.load(r):setTimeout(()=>this.load(r))}disconnectedCallback(){this.cleanup()}cleanup(){D.clear();for(let r of this.animations)r.cancel();this.animations=[]}update(r){this.cleanup();let i=this.get_use();r||(r=Ze(this.innerHTML)),this.innerHTML=r,this.grid_size||(this.grid_size=this.get_grid());let{x:n,y:s,z:a}=this.grid_size;const l=this.generate(J(i+r,this.extra));if(!this.shadowRoot.innerHTML)return Object.assign(this.grid_size,l.grid),this.build_grid(l,l.grid);if(l.grid){let{x:o,y:c,z:f}=l.grid;if(n!==o||s!==c||a!==f)return Object.assign(this.grid_size,l.grid),this.build_grid(l,l.grid);Object.assign(this.grid_size,l.grid)}else{let o=this.get_grid(),{x:c,y:f,z:m}=o;if(n!==c||s!==f||a!==m)return Object.assign(this.grid_size,o),this.build_grid(this.generate(J(i+r,this.extra)),o)}let u=this.replace(l);this.set_content(".style-keyframes",u(l.styles.keyframes)),l.props.has_animation&&(this.set_content(".style-cells",""),this.set_content(".style-container","")),setTimeout(()=>{this.set_content(".style-container",u(Ue(this.grid_size)+l.styles.host+l.styles.container)),this.set_content(".style-cells",u(l.styles.cells))})}get grid(){return Object.assign({},this.grid_size)}set grid(r){this.attr("grid",r),this.connectedCallback(!0)}get seed(){return this._seed_value}set seed(r){this.attr("seed",r),this.connectedCallback(!0)}get use(){return this.attr("use")}set use(r){this.attr("use",r),this.connectedCallback(!0)}get_max_grid(){return this.hasAttribute("experimental")?256:64}get_grid(){return et(this.attr("grid"),this.get_max_grid())}get_use(){let r=String(this.attr("use")||"").trim();return/^var\(/.test(r)&&(r=`@use:${r};`),r}attr(r,i){if(arguments.length===1)return this.getAttribute(r);if(arguments.length===2)return this.setAttribute(r,i),i}generate(r){let i=this.get_grid(),n=this.attr("seed")||this.attr("data-seed");x(n)&&(n=Date.now());let s=this.compiled=Mt(r,i,n,this.get_max_grid());return this._seed_value=s.seed,this._seed_random=s.random,s}doodle_to_image(r,i,n){typeof i=="function"&&(n=i,i=null),r=":doodle { width:100%;height:100% }"+r;let s=J(r,this.extra),a=et(""),l=Mt(s,a,this._seed_value,this.get_max_grid(),this._seed_random),u=l.grid?l.grid:a;const{keyframes:o,host:c,container:f,cells:m}=l.styles;let h=this.replace(l),p=qt(u),d=i&&i.width&&i.height?`width="${i.width}" height="${i.height}"`:"";h(`
        <svg ${d} xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
          <foreignObject width="100%" height="100%">
            <div class="host" xmlns="http://www.w3.org/1999/xhtml">
              <style>
                ${Ut()}
                ${Ue(u)}
                ${c}
                ${f}
                ${m}
                ${o}
              </style>
              <svg id="defs" xmlns="http://www.w3.org/2000/svg" style="width:0; height:0"></svg>
              ${p}
            </div>
          </foreignObject>
        </svg>
      `).then(g=>{let y=`data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(g)))}`;Ve()&&Qt(y),n(y)})}pattern_to_image({code:r,cell:i,id:n},s){let a=Mn(r,this.extra);this.shader_to_image({shader:a,cell:i,id:n},s)}canvas_to_image({code:r},i){Bn(r).then(i)}pause(){this.setAttribute("cssd-paused-animation",!0);for(let r of this.animations)r.pause()}resume(){this.removeAttribute("cssd-paused-animation");for(let r of this.animations)r.resume()}shader_to_image({shader:r,cell:i,id:n},s){let a=typeof r=="string"?Ii(r):r,l=this.doodle.getElementById(i);const u=this.seed,o=p=>{l.style.setProperty(n,`url(${p})`)},c=p=>{if(typeof p=="function"){let d=Vn(g=>{o(p(g))});return this.animations.push(d),""}o(p)};let{width:f,height:m}=l&&l.getBoundingClientRect()||{width:0,height:0},h=window.devicePixelRatio||1;if(!a.textures.length||a.ticker)Bt(a,f,m,u).then(c).then(s);else{let p=a.textures.map(d=>new Promise(g=>{this.doodle_to_image(d.value,{width:f,height:m},y=>{let _=new Image;_.width=f*h,_.height=m*h,_.onload=()=>g({name:d.name,value:_}),_.src=y})}));Promise.all(p).then(d=>{a.textures=d,Bt(a,f,m,u).then(c).then(s)})}}load(r){this.cleanup();let i=this.get_use(),n=J(i+Ze(this.innerHTML),this.extra),s=this.generate(n);r||this.hasAttribute("click-to-update")&&this.addEventListener("click",a=>this.update()),this.grid_size=s.grid?s.grid:this.get_grid(),this.build_grid(s,this.grid_size)}replace({doodles:r,shaders:i,canvas:n,pattern:s}){let a=Object.keys(r),l=Object.keys(i),u=Object.keys(n),o=Object.keys(s),c=a.length+u.length+l.length+o.length;return f=>{if(!c)return Promise.resolve(f);let m=[].concat(a.map(h=>f.includes(h)?new Promise(p=>{this.doodle_to_image(r[h],d=>p({id:h,value:d}))}):Promise.resolve("")),l.map(h=>f.includes(h)?new Promise(p=>{this.shader_to_image(i[h],d=>p({id:h,value:d}))}):Promise.resolve("")),u.map(h=>f.includes(h)?new Promise(p=>{this.canvas_to_image(n[h],d=>p({id:h,value:d}))}):Promise.resolve("")),o.map(h=>f.includes(h)?new Promise(p=>{this.pattern_to_image(s[h],d=>p({id:h,value:d}))}):Promise.resolve("")));return Promise.all(m).then(h=>{for(let{id:p,value:d}of h){let g=`url(${d})`;/^canvas/.test(p)&&(g=d),/^shader|^pattern/.test(p)&&(g=`var(--${p})`),f=f.replaceAll("${"+p+"}",g)}return f})}}build_grid(r,i){const{has_transition:n,has_animation:s}=r.props;let a=n||s;const{keyframes:l,host:u,container:o,cells:c}=r.styles;let f=Ue(i)+u+o,m=a?"":c;const{uniforms:h}=r;let p=this.replace(r);this.doodle.innerHTML=`
        <style>${Ut()}</style>
        <style class="style-keyframes">${l}</style>
        <style class="style-container">${f}</style>
        <style class="style-cells">${m}</style>
        <svg id="defs" xmlns="http://www.w3.org/2000/svg" style="width:0;height:0"></svg>
        ${qt(i)}
      `,this.set_content(".style-container",p(f)),a?setTimeout(()=>{this.set_content(".style-cells",p(c))},50):this.set_content(".style-cells",p(c)),h.time&&this.register_uniform_time(),h.mousex||h.mousey?this.register_uniform_mouse(h):this.remove_uniform_mouse(),h.width||h.height?this.register_uniform_resolution(h):this.remove_uniform_resolution()}register_uniform_mouse(r){if(!this.uniform_mouse_callback){let{uniform_mousex:i,uniform_mousey:n}=H;this.uniform_mouse_callback=a=>{let l=a.detail||a;r.mousex&&this.style.setProperty("--"+i.name,l.offsetX),r.mousey&&this.style.setProperty("--"+n.name,l.offsetY)},this.addEventListener("pointermove",this.uniform_mouse_callback);let s=new CustomEvent("pointermove",{detail:{offsetX:0,offsetY:0}});this.dispatchEvent(s)}}remove_uniform_mouse(){if(this.uniform_mouse_callback){let{uniform_mousex:r,uniform_mousey:i}=H;this.style.removeProperty("--"+r.name),this.style.removeProperty("--"+i.name),this.removeEventListener("pointermove",this.uniform_mouse_callback),this.uniform_mouse_callback=null}}register_uniform_resolution(r){if(!this.uniform_resolution_observer){let{uniform_width:i,uniform_height:n}=H;const s=()=>{let a=this.getBoundingClientRect();r.width&&this.style.setProperty("--"+i.name,a.width),r.height&&this.style.setProperty("--"+n.name,a.height)};s(),this.uniform_resolution_observer=new ResizeObserver(a=>{for(let l of a)(l.contentBoxSize||l.contentRect)&&s()}),this.uniform_resolution_observer.observe(this)}}remove_uniform_resolution(){if(this.uniform_resolution_observer){let{uniform_width:r,uniform_height:i}=H;this.style.removeProperty("--"+r.name),this.style.removeProperty("--"+i.name),this.uniform_resolution_observer.unobserve(this),this.uniform_resolution_observer=null}}register_uniform_time(){if(!window.CSS||!window.CSS.registerProperty)return!1;if(!this.is_uniform_time_registered){let{uniform_time:r}=H;try{CSS.registerProperty({name:"--"+r.name,syntax:"<number>",initialValue:0,inherits:!0})}catch{}this.is_uniform_time_registered=!0}}export({scale:r,name:i,download:n,detail:s}={}){return new Promise((a,l)=>{let u=Un(this),o=this.doodle.innerHTML,{width:c,height:f}=this.getBoundingClientRect();r=parseInt(r)||1;let m=c*r,h=f*r,p=`
          <svg xmlns="http://www.w3.org/2000/svg"
            preserveAspectRatio="none"
            viewBox="0 0 ${c} ${f}"
            ${Ve()?"":`width="${m}px" height="${h}px"`}
          >
            <foreignObject width="100%" height="100%">
              <div
                class="host"
                xmlns="http://www.w3.org/1999/xhtml"
                style="width: ${c}px; height: ${f}px; "
              >
                <style>.host { ${hi(u)} }</style>
                ${o}
              </div>
            </foreignObject>
          </svg>
        `;n||s?Dn(p,m,h,r).then(({source:d,url:g,blob:y})=>{if(a({width:m,height:h,svg:p,blob:y,source:d}),n){let _=document.createElement("a");_.download=fi(i),_.href=g,_.click()}}).catch(d=>{l(d)}):a({width:m,height:h,svg:p})})}set_content(r,i){if(i instanceof Promise)i.then(n=>{this.set_content(r,n)});else{const n=this.shadowRoot.querySelector(r);n&&(n.styleSheet?n.styleSheet.cssText=i:n.innerHTML=i)}}}customElements.get("css-doodle")||customElements.define("css-doodle",e)}function Ut(){let{uniform_time:e}=H;const t=wr(/grid/).map(r=>`${r}: inherit;`).join("");return`
    *, *::after, *::before {
      box-sizing: border-box;
      animation-play-state: var(--cssd-animation-play-state) !important;
    }
    :host, .host {
      display: block;
      visibility: visible;
      width: auto;
      height: auto;
      --${e.name}: 0
    }
    :host([hidden]), .host[hidden] {
      display: none
    }
    .container {
      position: relative;
      width: 100%;
      height: 100%;
      display: grid;
      ${t}
    }
    cell:empty {
      position: relative;
      line-height: 1;
      display: grid;
      place-items: center
    }
    svg {
      position: absolute;
      width: 100%;
      height: 100%;
    }
    :host([cssd-paused-animation]) {
      --cssd-animation-play-state: paused;
      animation-play-state: paused !important;
    }
  `}function Ue(e){let{x:t,y:r}=e||{};return`
    :host, .host {
      grid-template-rows: repeat(${r}, 1fr);
      grid-template-columns: repeat(${t}, 1fr);
    }
  `}function Ft(e,t,r){let i=document.createElement("cell");return i.id=ee(e,t,r),i}function qt(e){let{x:t,y:r,z:i}=e||{},n=document.createElement("grid"),s=document.createDocumentFragment();if(i==1)for(let a=1;a<=r;++a)for(let l=1;l<=t;++l)s.appendChild(Ft(l,a,1));else{let a=null;for(let l=1;l<=i;++l){let u=Ft(1,1,l);(a||s).appendChild(u),a=u}a=null}return n.className="container",n.appendChild(s),n.outerHTML}const{document:Fe}=Mr;function Zn(e){let t,r,i,n;return{c(){t=te("script"),i=te("script"),n=Gt(`window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag("js", new Date());
    gtag("config", "G-KL11ZHZSTB");`),this.h()},l(s){const a=Lr("svelte-ip12h6",Fe.head);t=re(a,"SCRIPT",{src:!0});var l=ie(t);l.forEach(T),i=re(a,"SCRIPT",{});var u=ie(i);n=Yt(u,`window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag("js", new Date());
    gtag("config", "G-KL11ZHZSTB");`),u.forEach(T),a.forEach(T),this.h()},h(){t.async=!0,zr(t.src,r="https://www.googletagmanager.com/gtag/js?id=G-KL11ZHZSTB")||$e(t,"src",r)},m(s,a){Q(Fe.head,t),Q(Fe.head,i),Q(i,n)},p:be,i:be,o:be,d(s){T(t),T(i)}}}function Gn(e,t,r){let i;return Ir(e,Jr,n=>r(0,i=n)),e.$$.update=()=>{e.$$.dirty&1&&typeof gtag<"u"&&gtag("config","G-KL11ZHZSTB",{page_title:document.title,page_path:i.url.pathname})},[i]}class Yn extends Vt{constructor(t){super(),Zt(this,t,Gn,Zn,ut,{})}}function Xt(e,{delay:t=0,duration:r=400,easing:i=Or}={}){const n=+getComputedStyle(e).opacity;return{delay:t,duration:r,easing:i,css:s=>`opacity: ${s*n}`}}function Ht(e){let t,r,i,n,s,a;r=new Yn({});const l=e[2].default,u=Wr(l,e,e[1],null);return{c(){t=te("div"),Dr(r.$$.fragment),i=qe(),u&&u.c(),this.h()},l(o){t=re(o,"DIV",{class:!0});var c=ie(t);Ur(r.$$.fragment,c),i=Xe(c),u&&u.l(c),c.forEach(T),this.h()},h(){$e(t,"class","w-full h-full min-h-[100vh]")},m(o,c){Y(o,t,c),Fr(r,t,null),Q(t,i),u&&u.m(t,null),a=!0},p(o,c){u&&u.p&&(!a||c&2)&&qr(u,l,o,o[1],a?Hr(l,o[1],c,null):Xr(o[1]),null)},i(o){a||(ke(r.$$.fragment,o),ke(u,o),Vr(()=>{a&&(s&&s.end(1),n=Zr(t,Xt,{duration:150,delay:150}),n.start())}),a=!0)},o(o){Se(r.$$.fragment,o),Se(u,o),n&&n.invalidate(),s=Gr(t,Xt,{duration:150}),a=!1},d(o){o&&T(t),Yr(r),u&&u.d(o),o&&s&&s.end()}}}function Kn(e){let t,r,i=e[0].currentRoute,n,s,a,l,u=Ht(e);return{c(){t=te("div"),r=qe(),u.c(),n=qe(),s=te("footer"),a=Gt(`This website is made of love, and shoulder pain as well as endless support
    from Svelte community.`),this.h()},l(o){t=re(o,"DIV",{class:!0});var c=ie(t);c.forEach(T),r=Xe(o),u.l(o),n=Xe(o),s=re(o,"FOOTER",{class:!0});var f=ie(s);a=Yt(f,`This website is made of love, and shoulder pain as well as endless support
    from Svelte community.`),f.forEach(T),this.h()},h(){$e(t,"class","absolute h-full w-full flex items-start justify-center overflow-hidden z-[-1] pointer-events-none"),$e(s,"class","flex items-center justify-center mt-[120px] z-[-1]")},m(o,c){Y(o,t,c),Y(o,r,c),u.m(o,c),Y(o,n,c),Y(o,s,c),Q(s,a),l=!0},p(o,[c]){c&1&&ut(i,i=o[0].currentRoute)?(Kr(),Se(u,1,1,be),Br(),u=Ht(o),u.c(),ke(u,1),u.m(n.parentNode,n)):u.p(o,c)},i(o){l||(ke(u),l=!0)},o(o){Se(u),l=!1},d(o){o&&T(t),o&&T(r),u.d(o),o&&T(n),o&&T(s)}}}function Jn(e,t,r){let{$$slots:i={},$$scope:n}=t,{data:s}=t;return e.$$set=a=>{"data"in a&&r(0,s=a.data),"$$scope"in a&&r(1,n=a.$$scope)},[s,n,i]}class is extends Vt{constructor(t){super(),Zt(this,t,Jn,Kn,ut,{data:0})}}export{is as component,rs as universal};
